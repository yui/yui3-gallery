YUI.add("gallery-charts-stockindicators",function(e,t){function r(){this.init.apply(this,arguments)}function i(){i.superclass.constructor.apply(this,arguments)}var n={value:null};e.CategoryAxisBase.ATTRS.labelFormat=n,e.CategoryAxis.ATTRS.labelFormat=n,e.CartesianSeries.prototype.destructor=function(){this.get("rendered")&&(this._xDataReadyHandle&&this._xDataReadyHandle.detach(),this._xDataUpdateHandle&&this._xDataUpdateHandle.detach(),this._yDataReadyHandle&&this._yDataReadyHandle.detach(),this._yDataUpdateHandle&&this._yDataUpdateHandle.detach(),this._xAxisChangeHandle&&this._xAxisChangeHandle.detach(),this._yAxisChangeHandle&&this._yAxisChangeHandle.detach())},e.VMLShape&&(e.VMLShape.ATTRS.stroke.setter=function(t){var n,r,i,s=this.get("stroke")||this._getDefaultStroke();if(t){t.hasOwnProperty("weight")&&(i=parseInt(t.weight,10),isNaN(i)||(t.weight=i));for(n in t)t.hasOwnProperty(n)&&(s[n]=t[n])}return s.color&&s.color.toLowerCase().indexOf("rgba")>-1&&(s.opacity=e.Color._getAlpha(s.color),s.color=e.Color.toHex(s.color)),r=s,this._strokeFlag=!0,r},e.VMLShape.ATTRS.fill.setter=function(t){var n,r,i=this.get("fill")||this._getDefaultFill();if(t){t.hasOwnProperty("color")&&(t.type="solid");for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n])}return r=i,r&&r.color&&(r.color===undefined||r.color==="none"?r.color=null:r.color.toLowerCase().indexOf("rgba")>-1&&(r.opacity=e.Color._getAlpha(r.color),r.color=e.Color.toHex(r.color))),this._fillFlag=!0,r}),e.Crosshair=function(){this.initializer.apply(this,arguments)},e.Crosshair.prototype={initializer:function(t){var n=new e.Graphic({render:t.render,autoDraw:!1,width:t.width,height:t.height,x:t.x,y:t.y}),r=t.width,i=t.height,s=t.series,o,u=t.category,a,f,l=s.length;a=n.addShape({shapeRendering:"crispEdges",type:"path",stroke:u.stroke}).moveTo(0,0).lineTo(0,i).end(),this._xcoords=u.coords,this._yline=a,this.width=t.width,this.height=t.height;if(s){for(f=0;f<l;f+=1)o=s[f],o.line&&(o.xLine=n.addShape({shapeRendering:"crispEdges",type:"path",stroke:o.stroke,fill:o.fill}).moveTo(0,0).lineTo(r,0).end()),o.marker&&(o.marker.y=o.marker.height/-2,o.marker.x=o.marker.width/-2,o.marker.type=o.marker.type||o.marker.shape,o.marker=n.addShape(o.marker));this._series=s}this._xy=n.getXY(),this.graphic=n},setTarget:function(e){var t=this._xy,n=e-t[0],r,i=this._series,s,o,u=Math.floor(n/this.width*this._xcoords.length),a=i.length;this._yline.set("transform","translate("+n+")");if(i)for(o=0;o<a;o+=1)s=i[o],r=s.coords[u],s.marker&&s.marker.set("transform","translate("+n+", "+r+")"),s.line&&s.line.set("transform","translate("+n+", "+r+")");this.graphic._redraw()},destroy:function(){var e=this._series,t=this._yline,n,r,i;if(e){i=e.length;for(r=0;r<i;r+=1)n=e[r],n.marker&&n.marker.get("graphic").destroy(),n.line&&n.line.get("graphic").destroy(),t&&t.get("graphic").destroy()}}},e.Gridlines=e.Base.create("gridlines",e.Base,[e.Renderer],{_path:null,remove:function(){var e=this._path;e&&e.destroy()},draw:function(){this.get("axis")&&this.get("graphic")&&this._drawGridlines.apply(this,arguments)},_drawGridlines:function(e,t,n,r){var i=this._path,s=this.get("axis"),o=s.get("position"),u,a=this.get("direction"),f=this.get("graphic"),l=this.get("styles").fill,c=this.get("styles").border,h=this.get("styles").line,p=l&&c?c:h,d,v;n=n||0,r=r||2,isFinite(e)&&isFinite(t)&&e>0&&t>0&&(o!=="none"&&s&&s.get("tickPoints")?u=s.get("tickPoints"):u=this._getPoints(s.get("styles").majorUnit.count,e,t),i?(i.set("width",e),i.set("height",t),i.set("stroke",p),l&&i.set("fill",l)):(d={type:"path",width:e,stroke:p,height:t},l&&(d.fill=l),i=f.addShape(d),i.addClass("yui3-gridlines"),this._path=i),a==="vertical"?(v=l?this._verticalFill:this._verticalLine,v(i,u,t,n,r,e)):(v=l?this._horizontalFill:this._horizontalLine,v(i,u,e,n,r,t)),i.end())},_getPoints:function(e,t,n){var r,i=[],s,o=e-1;for(r=0;r<e;r+=1)s=r/o,i[r]={x:t*s,y:n*s};return i},_horizontalLine:function(e,t,n){var r,i=t.length,s;for(r=0;r<i;r+=1)s=t[r].y,e.moveTo(0,s),e.lineTo(n,s)},_verticalLine:function(e,t,n){var r,i=t.length,s;for(r=0;r<i;r+=1)s=t[r].x,e.moveTo(s,0),e.lineTo(s,n)},_horizontalFill:function(e,t,n,r,i,s){var o,u,a,f=t.length;for(o=r;o<f;o+=i)u=t[o].y,a=o<f-1?t[o+1].y:s,e.moveTo(0,u),e.lineTo(0,a),e.lineTo(n,a),e.lineTo(n,u),e.lineTo(0,u),e.closePath()},_verticalFill:function(e,t,n,r,i,s){var o,u,a,f=t.length;for(o=r;o<f;o+=i)u=t[o].x,a=o<f-1?t[o+1].x:s,e.moveTo(u,0),e.lineTo(a,0),e.lineTo(a,n),e.lineTo(u,n),e.lineTo(u,0),e.closePath()},_getDefaultStyles:function(){var e={line:{color:"#f0efe9",weight:1,alpha:1},fill:null};return e}},{ATTRS:{direction:{},axis:{},graphic:{},count:{}}}),r.prototype={init:function(t){var n,r,i,s=t.valueKeys,o=t.displayKeys,u,a,f,l=this.items||{},c;this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.dataProvider=t.dataProvider,this.contentDiv=e.DOM.create('<div style="position:absolute;top:'+t.y+"px;"+t.x+"0px;height: "+t.height+"px; width: "+t.width+'px;" class="l-hbox">'),this.dateLabelFunction=t.dateLabelFunction,this.dateLabelFormat=t.dateLabelFormat,this.dateLabelScope=t.dateLabelScope||this,t.render.getDOMNode().appendChild(this.contentDiv),i=s.length,r=e.DOM.create('<ul  style="vertical-align: middle; line-height: '+this.height+'px;padding:0px 0px 0px 0px;margin:0px 0px 0px 0px;" class="layout-item-modules pure-g">'),this.contentDiv.appendChild(r),this.dateItem={li:e.DOM.create('<li class="layout-item-module pure-u" style="display:inline-block; margin: 0px 4px 0px 0px;">'),value:e.DOM.create('<span style="border-left:'+t.swatchWidth+"px solid #fff;font-size:"+t.fontSize+";font-family:"+t.font+';" id="dateitem";font-color:'+t.dateColor+'" ></span>')},this.dateItem.li.appendChild(this.dateItem.value),r.appendChild(this.dateItem.li);for(n=0;n<i;n+=1)f=s[n],u=o[n],a={},c=t.colors[f],a.li=e.DOM.create('<li id="'+f+'" class="layout-item-module pure-u" style="display:inline-block; margin: 0px 4px 0px 0px;">'),a.bullet=e.DOM.create('<div style="display: inline-block;width:3px; height: '+this
.height+"px; background-color:"+c+';"></div>'),a.label=e.DOM.create('<span style="font-size:'+t.fontSize+";font-family:"+t.font+";color:"+c+';display:inline:margin: 0px 0px 0px 0px;" id="'+f+'" >'+t.delim+u+" : </span>"),a.value=e.DOM.create('<span style="font-size:'+t.fontSize+";font-family:"+t.font+';display:inline:margin: 0px 0px 0px 0px;" id="'+f+'Value" ></span>'),r.appendChild(a.li),a.li.appendChild(a.bullet),a.li.appendChild(a.label),a.li.appendChild(a.value),l[f]=a,a.li.style.display="none";this.list=r,this.seriesQueue=s,this.items=l,this.priceUpColor=t.priceUpColor,this.priceDownColor=t.priceDownColor,this.valueLabelFormat=t.valueLabelFormat,this.formatDate=t.formatDate,this._xy=e.DOM.getXY(this.contentDiv)},destroy:function(){this._removeChildren(this.list),this._removeChildren(this.contentDiv),this.contentDiv&&this.contentDiv.parentNode&&this.contentDiv.parentNode.removeChild(this.contentDiv)},_removeChildren:function(e){if(e&&e.hasChildNodes()){var t;while(e.firstChild)t=e.firstChild,this._removeChildren(t),e.removeChild(t)}},update:function(t,n){var r=this._xy,i=t-r[0],s=Math.floor(i/this.width*n.length),o=n[s],u=this.seriesQueue,a,f=u.length,l,c=this.items,h,p,d=this.dateLabelFunction,v=this.dateLabelScope,m=this.dateLabelFormat,g;p=o.Date||o.Timestamp,d&&(g=[p],m&&g.push(m),p=d.apply(v,g)),this.dateItem.value.innerHTML=e.Escape.html(p);for(h=0;h<f;h+=1)a=u[h],l=c[a],o.hasOwnProperty(a)?(l.li.style.display="inline-block",p=o[a],l.value.innerHTML=e.Number.format(parseFloat(p),this.valueLabelFormat),e.DOM.setStyle(l.value,"color",p>0?this.priceUpColor:this.priceDownColor)):l.li.style.display="none"}},e.StockIndicatorsLegend=r,i.NAME="stockChart",i.ATTRS={charts:{},dataProvider:{lazyAdd:!1,getter:function(){return this._dataProvider},setter:function(e){return this._dataProvider=e,e}}},e.extend(i,e.Widget,{drawCharts:function(){var e=[],t=this.get("charts"),n=this.get("contentBox"),r,i=t.length;this._removeAll();for(r=0;r<i;r+=1)e[r]=this.drawChart(t[r],n);this._charts=e},updatesLegendsCrosshair:function(e){var t,n=this._crosshairs,r=this._legends,i=e&&e.hasOwnProperty("changedTouches"),s=i?e.changedTouches[0].pageX:e.pageX,o=i?e.changedTouches[0].pageY:e.pageY,u=n.length,a,f,l,c;if(s%1===0&&o%1===0&&this.curX!==s){for(c=0;c<u;c+=1)a=this._charts[c],f=a.xy,l=s-f[0],t=this._crosshairs[c],t.setTarget(s);u=r.length;for(c=0;c<u;c+=1)r[c].update(s,this._dataProvider)}this.curX=s},initializer:function(){var e=this.get("contentBox");e.setStyle("position","relative"),this._axes=[],this._graphs=[],this._graphics=[],this._crosshairs=[],this._hotspots=[],this._legends=[],i.superclass.initializer.apply(this,arguments)},_graphMap:{line:e.LineSeries,marker:e.MarkerSeries,column:e.ColumnSeries,candlestick:e.CandlestickSeries},_getGraph:function(e){return this._graphMap[e]},_getSeriesCollection:function(e){var t=[],n,r=e.indicators,i,s,o=r.length,u,a,f;for(s=0;s<o;s+=1){n=r[s],f=n.valueKey;if(n.type==="candlestick"||typeof f=="string")t.push({type:n.type,xKey:e.categoryKey,yKey:n.valueKey});else{a=f.length;for(u=0;u<a;u+=1)i=n.type,t.push({type:typeof i=="string"?i:i[u],xKey:e.categoryKey,yKey:n.valueKey[u]})}}return t},_getSeriesStyles:function(e,t){var n,r=t.colors,i,s,o,u,a,f=e.length;for(a=0;a<f;a+=1){n=e[a];switch(n.type){case"line":n.styles={line:{weight:t.lineWidth,color:r[n.yKey]}};break;case"candlestick":n.styles={upcandle:{fill:{color:r.priceUp}},downcandle:{fill:{color:r.priceDown}}};break;case"marker":o=this.get("dataProvider"),i=Math.min(t.dotDiameter,t.width/o.length),n.styles={marker:{width:i,height:i,border:{color:r[n.yKey],weight:0},fill:{color:r[n.yKey]}}};break;case"column":o=this.get("dataProvider"),u=t.rangeType,s=t.width/o.length,s=Math.min(10,Math.round(s-s*.4)),s-=2,s=Math.max(1,s),n.styles={marker:{width:s,border:{weight:0},fill:{color:r[n.yKey]}}}}}return e},_drawGraphs:function(e,t,n){var r=this._getSeriesStyles(this._getSeriesCollection(e),e),i,s,o,u={},a=t.date,f=t.numeric,l,c,h=r.length;for(c=0;c<h;c+=1)i=r[c],i.xAxis=a,i.yAxis=f,i.graphic=n,l=this._getGraph(i.type),o=new l(i),o.draw(),s=i.yKey,typeof s!="string"&&(s="quote"),u[s]=o;return this._graphs.push(o),u},_drawGridlines:function(t,n,r){var i=r.get("width"),s=r.get("height"),o=new e.Gridlines({graphic:r,direction:"horizontal",axis:n.numeric}),u=new e.Gridlines({graphic:r,direction:"vertical",axis:n.date,styles:{fill:{color:t.gridColor},border:{weight:0}}});return o.draw(i,s),u.draw(i,s,t.rangeType==="intraday"?0:1),o._path.toBack(),u._path.toBack(),{horizontal:o,vertical:u}},_drawAxes:function(t,n){var r,i,s=t.axes.numeric,o=t.axes.date,u,a;return s.render=n,s.y=t.y+t.legend.height,s.x=t.width-s.width,s.height=t.height-o.height-t.legend.height,o.render=n,o.y=t.y+t.height-o.height,o.width=t.width,u=new e.NumericAxis(s),a=new e.CategoryAxis(o),i=a.get("boundingBox"),i.setStyle("left","0px"),i.setStyle("top",t.y+t.height-o.height+"px"),i=u.get("boundingBox"),i.setStyle("left",s.x+"px"),i.setStyle("top",t.y+t.legend.height+"px"),r={numeric:u,date:a},this._axes.push(r),r},_drawHotspot:function(t,n){var r=e.Node.create('<div class="yui3-hotspot" id="fincharthotspot_'+this._hotspots.length+'" style="width:'+t.width+"px;height:"+(t.height-t.legend.height-t.axes.date.height)+"px;position:absolute;left:0px;top:"+(t.y+t.legend.height)+'px;opacity:0;background:#fff;z-index:4"></div>');r.setStyle("opacity",0),n.append(r),this._hotspots.push(r)},_createGraphic:function(t,n){var r=new e.Graphic({render:n,width:this.get("width"),height:t.height-t.legend.height-t.axes.date.height,x:0,y:t.y+t.legend.height,autoDraw:!1});return this._graphics.push(r),r},_addCrosshair:function(t,n,r){var i,s=t.crosshair,o={stroke:{color:s.lineColor,weight:s.lineWidth}},u=[],a,f,l=t.colors;for(f in n)n.hasOwnProperty(f)&&(a=n[f],u.push({marker:{shape:"circle",width:s.dotDiameter,height:s.dotDiameter,fill:{color:l[f==="quote"?"close":f]},stroke:{weight:0}},coords:f==="quote"?a.get("ycoords").close:a.get("ycoords")}),o.coords=a.get("xcoords"));return i=new 
e.Crosshair({width:t.width,height:t.height-t.axes.date.height-t.legend.height,x:0,y:t.y+t.legend.height,render:r,series:u,category:o}),this._crosshairs.push(i),i},_addLegend:function(t,n){var r,i=t.legend;return i.colors=t.colors,i.render=n,i.y=t.y,r=new e.StockIndicatorsLegend(i),this._legends.push(r),r},drawChart:function(e,t){var n,r=this._drawAxes(e,t),i=this._createGraphic(e,t),s=this._drawGridlines(e,r,i),o=this._drawGraphs(e,r,i),u=this._drawHotspot(e,t),a=this._addCrosshair(e,o,t),f=this._addLegend(e,t);return n={axes:r,graphic:i,gridlines:s,graphs:o,hotspot:u,crosshair:a,legend:f,xy:i.getXY()},i._redraw(),n},_destroyCrosshairs:function(){var e,t=this._charts.length,n;while(this._crosshairs.length>0)n=this._crosshairs.pop(),n.destroy();for(e=0;e<t;e+=1)delete this._charts[e].crosshair},_destroyHotspots:function(){var e,t=this._charts.length,n;while(this._hotspots.length>0)n=this._hotspots.pop(),n.empty(),n.remove(!0);for(e=0;e<t;e+=1)delete this._charts[e].hotspot},_destroyAxes:function(){var e,t=this._charts.length,n;while(this._axes.length>0)n=this._axes.pop(),n.date.destroy(!0),n.numeric.destroy(!0);for(e=0;e<t;e+=1)delete this._charts[e].axes},_destroyGraphs:function(){var e,t=this._charts.length,n;while(this._graphs.length>0)n=this._graphs.pop(),n.destroy(!0);for(e=0;e<t;e+=1)delete this._charts[e].graph},_destroyLegends:function(){var e,t=this._charts.length,n;while(this._legends.length>0)n=this._legends.pop(),n.destroy();for(e=0;e<t;e+=1)delete this._charts[e].legend},_destroyGraphics:function(){var e,t=this._charts.length,n;while(this._graphics.length>0)n=this._graphics.pop(),n.destroy();for(e=0;e<t;e+=1)delete this._charts[e].graphic},_removeAll:function(){var e,t;if(this._charts){this._destroyCrosshairs(),this._destroyHotspots(),this._destroyLegends(),this._destroyGraphs(),this._destroyAxes(),this._destroyGraphics();while(this._charts.length>0){e=this._charts.pop();for(t in e)e.hasOwnProperty(t)&&delete e[t]}}},destructor:function(){this._removeAll()}}),e.StockIndicatorsChart=i},"gallery-2013.12.20-18-06",{requires:["graphics-group","axis-numeric","axis-category","series-line","series-marker","series-column","series-candlestick"]});
