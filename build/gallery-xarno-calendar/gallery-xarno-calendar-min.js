YUI.add("gallery-xarno-calendar",function(e){var c="select",b="update",d="date",a=e.Lang;e.namespace("Xarno").Calendar=e.Base.create("xarno-calendar",e.Widget,[e.WidgetStdMod],{_cal:null,initializer:function(f){this.publish(b,{defaultFn:this._defUpdateFn});this.publish(c,{defaultFn:this._defSelectFn});},renderUI:function(){this._cal=e.Node.create(this.get("calendarTemplate"));this._buildDaysOfTheWeek();this._buildDays();},bindUI:function(){this.after("dateChange",function(f){this.fire(b);},this);this._cal.delegate("click",function(f){this.fire(c,{click:f});},".liner",this);},syncUI:function(){this.setStdModContent("body",this._cal,"after");},prevMonth:function(){var f=this.get(d);f.setMonth(f.getMonth()-1);this.set(d,f);return this;},nextMonth:function(){var f=this.get(d);f.setMonth(f.getMonth()+1);this.set(d,f);return this;},prevYear:function(){var f=this.get(d);f.setFullYear(f.getFullYear()-1);this.set(d,f);return this;},nextYear:function(){var f=this.get(d);f.setFullYear(f.getFullYear()+1);this.set(d,f);return this;},_dateValueFn:function(f){return new Date();},_weekStartSetter:function(f){return(f)?1:0;},_defUpdateFn:function(n){var p=new Date(this.get(d)),h=new Date(p),r=new Date(p),k=this.get("dateSelected"),g=this._cal,m,j,s=this.get("weekStart"),o=[],q=e.Node.create("<b />"),f=28+s;q.set("className",g.get("className"));p.setMonth(p.getMonth()+1);p.setDate(0);o=["d29","d30","d31"].splice(0,p.getDate()-28);q.replaceClass("d[0-9]+",o.join(" "));f+=o.length;p.setDate(0);o=[];if(p.getDate()-(p.getDate()-p.getDay()+s)<7){for(m=p.getDate()-p.getDay()+s,j=p.getDate();m<=j;m++){o.push("p"+m);}f+=o.length;}q.replaceClass("p[0-9]+",o.join(" "));o=[];for(m=1,j=42-(f-s);m<=j;m++){o.push("n"+m);}q.replaceClass("n[0-9]+",o.join(" "));g.set("className",q.get("className"));if(k){h.setDate(1);r.setMonth(r.getMonth()+1);r.setDate(0);if(h<=k&&r>=k){this._cal.one(".day-"+k.getDate()).addClass("selected");return;}}this._cal.all(".selected").removeClass("selected");},_defSelectFn:function(g){g=g.click;var h=new Date(this.get(d)),f=g.currentTarget.ancestor();this._cal.all(".selected").removeClass("selected");if(f.hasClass("previous")){h.setMonth(h.getMonth()-1);h.setDate(g.currentTarget.get("text"));this.set("dateSelected",h);this.prevMonth();return;}else{if(f.hasClass("next")){h.setMonth(h.getMonth()+1);h.setDate(g.currentTarget.get("text"));this.set("dateSelected",h);this.nextMonth();return;}}f.addClass("selected");h.setDate(g.currentTarget.get("text"));this.set("dateSelected",h);},_buildDaysOfTheWeek:function(){var k=this.get("daysOfTheWeek"),g=this.get("weekStart"),j="",h,f;if(g>0){k.push(k.splice(0,g));}j='<ul class="day-list">';for(h=0,f=k.length;h<f;h++){j+='<li class="day-name"><span class="liner">'+k[h]+"</span></li>";}j+="</ul>";this.setStdModContent("body",j);},_buildDays:function(){var m="",g,f,j=this.get("dayTemplate"),h=this.get("previousDayTemplate"),k=this.get("nextDayTemplate");for(g=22,f=31;g<=f;g++){m+=a.sub(h,{count:g});}for(g=1,f=31;g<=f;g++){m+=a.sub(j,{count:g});}for(g=1,f=14;g<=f;g++){m+=a.sub(k,{count:g});}this._cal.setContent(m);this.fire(b);}},{ATTRS:{date:{valueFn:"_dateValueFn"},dateSelected:{value:null},daysOfTheWeek:{value:["Su","Mo","Tu","We","Th","Fr","Sa"]},weekStart:{value:0,setter:"_weekStartSetter"},calendarTemplate:{value:"<ul />"},dayTemplate:{value:'<li class="day day-{count}"><a class="liner">{count}</a></li>'},previousDayTemplate:{value:'<li class="day previous previous-day-{count}"><span class="liner">{count}</span></li>'},nextDayTemplate:{value:'<li class="day next next-day-{count}"><span class="liner">{count}</span></li>'}}});},"gallery-2011.02.02-21-07",{requires:["base-build","widget","widget-stdmod"]});