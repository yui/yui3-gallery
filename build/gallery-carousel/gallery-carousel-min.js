YUI.add("gallery-carousel",function(b){function h(){h.superclass.constructor.apply(this,arguments);}var d=b.ClassNameManager.getClassName,g=b.Lang,f=b.Node,m=false,e=true,a="afterScroll",j="beforeScroll",c="itemAdded",l="itemRemoved",k="itemSelected",i="navStateChanged";h.NAME="carousel";h.ATTRS={autoPlayInterval:{validator:g.isNumber,value:0},carouselItemEl:{validator:g.isString,value:"li"},hidePagination:{validator:g.isBoolean,value:false},isCircular:{validator:g.isBoolean,value:false},isVertical:{setter:"_setVertical",validator:g.isBoolean,value:false},useMenuForNav:{validator:g.isBoolean,value:false},numItems:{value:0},numVisible:{validator:"_validateNumVisible",value:3},revealAmount:{validator:"_validateRevealAmount",value:0},scrollIncrement:{validator:g.isNumber,value:1},selectedItem:{validator:g.isNumber,value:0},strings:{value:{GOTO_PAGE:"Go to page {page}",NEXT_PAGE:"Next Page",PREV_PAGE:"Previous Page"}}};b.Carousel=b.extend(h,b.Widget,{addItem:function(r,s){var n=this,q,o,p;if(g.isString(r)){p=f.create(b.substitute(n.ITEM_TEMPLATE,{content:r}));}else{if(g.isObject(r)&&r.constructor.NAME==="node"){p=r;}else{return false;}}if(!n._vtbl.item.content){n._vtbl.item.content=p;}if(g.isUndefined(s)){n._vtbl.items.push(p);o=n._vtbl.items.length-1;}else{if(!n._vtbl.items[s]){n._vtbl.items[s]=undefined;}n._vtbl.items.splice(s,1,p);o=s;}q=this.get("numItems");this.set("numItems",q+1);this.fire(c,{item:p,pos:o});return true;},addItems:function(p){var o=this,t=false,r,q,s;if(!g.isArray(p)){return false;}t=true;for(q=0,s=p.length;q<s;++q){r=p[q].content;if(!o.addItem(r,p[q].pos)){t=false;}}return t;},clearItems:function(){var n=this,o=n._vtbl.items;while(o.length>0){n.removeItem(0);}},getElementForItem:function(n){return this.getItem(n);},getElementForItems:function(n){return this.getItems(n);},getFirstVisible:function(){var n=this,p=n.get("numVisible"),o=n.get("selectedItem");return n._getFirstVisible(o,p);},getFirstVisibleOnPage:function(n){return(n-1)*this.get("numVisible");},getItem:function(o){var n=this;if(o<0||o>n._vtbl.items.length-1){return null;}return g.isUndefined(n._vtbl.items[o])?null:n._vtbl.items[o];},getItems:function(s){var p=this,o=[],q,r;if(g.isUndefined(s)){for(q=0,r=p._vtbl.items.length;q<r;++q){o[q]=p.getItem(q);}}else{for(q=0,r=s.length;q<r;++q){o[s[q]]=p.getItem(s[q]);}}return o;},getPageForItem:function(n){return Math.floor(n/this.get("numVisible"));},getVisibleItems:function(){var o=this,q=o.get("numVisible"),t=o.getFirstVisible(),s=[],p,r;for(p=t,r=t+q;p<r;++p){s.push(o._vtbl.items[p]);}return s;},removeItem:function(o){var n=this,q,p;if(o<0||o>n._vtbl.items.length-1){return false;}q=n._vtbl.items.splice(o,1);if(!q){return false;}p=n.get("numItems");--p;n.set("numItems",p);this.fire(l,{item:q,pos:o});return true;},scrollBackward:function(){var o=this,n=o.get("scrollIncrement"),p=o.get("selectedItem");o.scrollTo(p-n);},scrollForward:function(){var o=this,n=o.get("scrollIncrement"),p=o.get("selectedItem");o.scrollTo(p+n);},scrollPageBackward:function(){var n=this,p=n.get("numVisible"),o=n.get("selectedItem");n.scrollTo(o-p);},scrollPageForward:function(){var n=this,p=n.get("numVisible"),o=n.get("selectedItem");n.scrollTo(o+p);},scrollTo:function(r){var q=this,p=q.get("isCircular"),s=q.get("numItems"),o,n,u,t;if(r<0){if(p){r+=s;}else{r=0;}}else{if(r>s-1){if(p){r=s-r;}else{r=s-1;}}}t=q._getOffsetForIndex(r);n=q.get("contentBox");o=q.get("isVertical")?"top":"left";u=q.getFirstVisible();q.fire(j,{first:u,last:u+q.get("numVisible")});n.setStyle(o,t);u=q.getFirstVisible();q.fire(a,{first:u,last:u+q.get("numVisible")});q.set("selectedItem",r);},scrollToPage:function(o){var n=this;n.scrollTo(o*n.get("numVisible"));},bindUI:function(){var n=this,o=n.get("boundingBox");n.after("selectedItemChange",n._afterSelectedItemChange);if(!n.get("hidePagination")){o.delegate("click",b.bind(n._onNavItemClick,n),".yui3-carousel-nav-item > a");o.delegate("click",b.bind(n._onNavButtonClick,n),".yui3-carousel-button");}o.delegate("click",b.bind(n._onItemClick,n),".yui3-carousel-item");},initializer:function(){var n=this;n._vtbl={items:[],item:{content:null,hsz:0,vsz:0}};n.get("boundingBox").addClass(d(h.NAME,"loading"));n._parseItems();},renderUI:function(){var n=this;if(n.get("numItems")<1){n.get("boundingBox").addClass(d(h.NAME,"hidden"));return;}if(n._vtbl.item.hsz===0){n._vtbl.item.hsz=n._getNodeSize(n._vtbl.item.content,"width");}if(n._vtbl.item.vsz===0){n._vtbl.item.vsz=n._getNodeSize(n._vtbl.item.content,"height");}n._renderItems();if(!n.get("hidePagination")){n._renderNavigation();}n._renderContainer();},syncUI:function(){var n=this,o=n.get("selectedItem");n._uiSetSelectedItem(o,true);if(!n.get("hidePagination")){n._updateNavigation(o);}},_afterSelectedItemChange:function(o){var n=this;n._uiSetSelectedItem(o.prevVal,false);n._uiSetSelectedItem(o.newVal,true);n.fire(k,{pos:o.newVal});if(!n.get("hidePagination")){n._updateNavigation(o.newVal);}},_getFirstVisible:function(o,n){return o-(o%n);},_getOffsetForIndex:function(o){var n=this,p;p=n.get("isVertical")?n._vtbl.item.vsz:n._vtbl.item.hsz;return -p*o;},_getNodeSize:function(n,p){var o=0;if(n&&n.constructor.NAME==="node"){if(p==="height"){o=parseInt(n.getComputedStyle("marginTop"),10)+parseInt(n.getComputedStyle("paddingTop"),10)+parseInt(n.getComputedStyle("borderTopWidth"),10)+parseInt(n.getComputedStyle("height"),10)+parseInt(n.getComputedStyle("borderBottomWidth"),10)+parseInt(n.getComputedStyle("paddingBottom"),10)+parseInt(n.getComputedStyle("marginBottom"),10);}else{if(p=="width"){o=parseInt(n.getComputedStyle("marginLeft"),10)+parseInt(n.getComputedStyle("paddingLeft"),10)+parseInt(n.getComputedStyle("borderLeftWidth"),10)+parseInt(n.getComputedStyle("width"),10)+parseInt(n.getComputedStyle("borderRightWidth"),10)+parseInt(n.getComputedStyle("paddingRight"),10)+parseInt(n.getComputedStyle("marginRight"),10);}}}return o;},_onItemClick:function(u){var v=this,t=v.get("boundingBox"),n,o,r,p,q,s;r=u&&u.target?u.target:null;if(!r){return;
}u.preventDefault();n=t.one(".yui3-carousel-content");o=r;while(o&&o!=n){if(o.hasClass(v.ITEM_CLASS_NAME)){break;}o=o.get("parentNode");}if(o){s=v._vtbl.items;for(p=0,q=s.length;p<q;++p){if(o==s[p]){v.set("selectedItem",p);break;}}}},_onNavButtonClick:function(o){var n=this,p;o.preventDefault();p=o&&o.target?o.target:null;if(!p){return;}if(!p.test(".yui3-carousel-button")){p=p.ancestor();}if(p.hasClass("yui3-carousel-first-button")){if(m){n.scrollPageBackward();}}else{if(p.hasClass("yui3-carousel-next-button")){if(e){n.scrollPageForward();}}}},_onNavItemClick:function(p){var n=this,o,q;q=p&&p.target?p.target:null;if(!q){return;}p.preventDefault();o=q.get("href");if(o){o=parseInt(o.replace(/.*#(.*)$/,"$1"),10);if(g.isNumber(o)){n.scrollToPage(o-1);n._uiSetNavItem(q.ancestor());}}},_parseItems:function(){var p=this,n,o;n=p.get("contentBox");o=n.all(p.get("carouselItemEl"));o.each(function(r,q){if(!p.addItem(r)){}},p);},_renderContainer:function(){var n=this,u=n.get("boundingBox"),q=n.get("hidePagination"),r=n.get("numVisible"),o=n.get("revealAmount"),p=0,t,s;if(!q){t=u.one(".yui3-carousel-nav");p=n._getNodeSize(t,"height");}if(this.get("isVertical")){s=n._vtbl.item.vsz*r;if(o>0){s+=(s*o/100);}n._uiSetHeight(s+p);n._uiSetWidth(n._vtbl.item.vsz);n._uiSetWidthCB(n._vtbl.item.vsz);}else{s=n._vtbl.item.hsz*r;if(o>0){s+=(s*o/100);}n._uiSetWidth(s);n._uiSetHeight(n._vtbl.item.hsz+p);n._uiSetHeightCB(n._vtbl.item.hsz);}},_renderItems:function(){var q=this,p=q.get("contentBox"),o,s,u,t,r;if(q.get("isVertical")){o="top";r=q._vtbl.item.vsz;}else{o="left";r=q._vtbl.item.hsz;}for(s=0,u=q._vtbl.items.length;s<u;++s){t=q._vtbl.items[s];if(t){if(!t.inDoc()){if(s===0){p.appendChild(t);}else{p.insertBefore(t,q._vtbl.items[s-1]);}}t.setStyle(o,r*s);t.addClass(q.ITEM_CLASS_NAME);}}},_renderNavigation:function(){var w=this,r=w.get("boundingBox"),p=w.get("contentBox"),u=[],q,n,o,x,v;o=Math.ceil(w.get("numItems")/w.get("numVisible"));if(o<1){w.set("hidePagination",true);return;}x=w.get("strings.GOTO_PAGE");for(q=1;q<=o;++q){v=b.substitute(x,{page:q});u.push(b.substitute(w.DEF_NAV_ITEM_TEMPLATE,{pagenum:q,label:v}));}w._navBtns={prev:b.guid(),next:b.guid()};n=f.create(b.substitute(w.DEF_NAV_TEMPLATE,{nav_items:u.join(""),nav_prev_btn_id:w.prev,nav_prev_btn_text:w.get("strings.PREV_PAGE"),nav_next_btn_id:w.next,nav_next_btn_text:w.get("strings.NEXT_PAGE")}));r.insertBefore(n,p);},_setVertical:function(n,o){this._uiSetVertical(n);},_uiSetHeight:function(o){var n=this;if(o){n.get("boundingBox").setStyle("height",o);}},_uiSetHeightCB:function(o){var n=this;if(o){n.get("contentBox").setStyle("height",o);}},_uiSetNavItem:function(p){var n=this,q=n.get("boundingBox"),o;o=d(h.NAME,"nav-item-selected");q.all(".yui3-carousel-nav-item").removeClass(o);p.addClass(o);},_uiSetSelectedItem:function(p,n){var o=this,r=o._vtbl.items[p],q=d(h.NAME,"selected");if(r){if(n){r.addClass(q);}else{r.removeClass(q);}}},_uiSetVertical:function(o){var n=this.get("boundingBox");if(o){n.addClass(d(h.NAME,"vertical"));}else{n.addClass(d(h.NAME,"horizontal"));}},_uiSetWidth:function(o){var n=this;if(o){n.get("boundingBox").setStyle("width",o);}},_uiSetWidthCB:function(o){var n=this;if(o){n.get("contentBox").setStyle("width",o);}},_updateNavigation:function(t){var q=this,u=q.get("boundingBox"),p=q.get("isCircular"),r,o,s,n;t=t||q.get("selectedItem");q._uiSetSelectedItem(t,true);n=u.all(".yui3-carousel-nav-item");o=q.getPageForItem(t);q._uiSetNavItem(n.item(o));s=q.getPageForItem(q.get("numItems")-1);if(t===0){r=u.one(".yui3-carousel-next-button");if(r){r.removeClass("yui3-carousel-button-disabled");e=true;}if(!p){r=u.one(".yui3-carousel-first-button");if(r){r.addClass("yui3-carousel-first-button-disabled");m=false;}}}else{if(o==s){r=u.one(".yui3-carousel-first-button");if(r){r.removeClass("yui3-carousel-first-button-disabled");m=true;}if(!p){r=u.one(".yui3-carousel-next-button");if(r){r.addClass("yui3-carousel-button-disabled");e=false;}}}else{r=u.one(".yui3-carousel-first-button");if(r){r.removeClass("yui3-carousel-first-button-disabled");m=true;}r=u.one(".yui3-carousel-next-button");if(r){r.removeClass("yui3-carousel-button-disabled");e=true;}}}},_validateNumVisible:function(n,o){return n>0;},_validateRevealAmount:function(n,o){return n>=0&&n<=100;},ITEM_TEMPLATE:'<li class="'+self.ITEM_CLASS_NAME+'">{content}</li>',DEF_NAV_TEMPLATE:'<div class="yui3-carousel-nav">'+"<ul>{nav_items}</ul>"+'<span class="yui3-carousel-button yui3-carousel-first-button">'+'<button type="button">'+"{nav_prev_btn_text}</button>"+"</span>"+'<span class="yui3-carousel-button yui3-carousel-next-button">'+'<button type="button">'+"{nav_next_btn_text}</button>"+"</span>"+"</div>",ITEM_CLASS_NAME:"yui3-carousel-item",DEF_NAV_ITEM_TEMPLATE:'<li class="yui3-carousel-nav-item">'+'<a class="yui3-carousel-pager-item" '+'href="#{pagenum}"><em>{label}</em></a></li>',_navBtns:null,_vtbl:null});},"@VERSION@",{skinnable:true,requires:["widget"]});