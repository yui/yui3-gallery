YUI.add("gallery-carousel",function(B){function G(){G.superclass.constructor.apply(this,arguments);}var D=B.ClassNameManager.getClassName,F=B.Lang,E=B.Node,A="afterScroll",I="beforeScroll",C="itemAdded",K="itemRemoved",J="itemSelected",H="navStateChanged";G.NAME="carousel";G.ATTRS={autoPlayInterval:{validator:F.isNumber,value:0},carouselItemEl:{validator:F.isString,value:"li"},hidePagination:{validator:F.isBoolean,value:false},isCircular:{validator:F.isBoolean,value:false},isVertical:{setter:"_setVertical",validator:F.isBoolean,value:false},useMenuForNav:{validator:F.isBoolean,value:false},numItems:{value:0},numVisible:{validator:"_validateNumVisible",value:3},revealAmount:{validator:"_validateRevealAmount",value:0},scrollIncrement:{validator:F.isNumber,value:1},selectedItem:{validator:F.isNumber,value:0},strings:{value:{GOTO_PAGE:"Go to page {page}",NEXT_PAGE:"Next Page",PREV_PAGE:"Previous Page"}}};B.Carousel=B.extend(G,B.Widget,{addItem:function(P,Q){var L=this,O,M,N;if(F.isString(P)){N=E.create(B.substitute(L.ITEM_TEMPLATE,{content:P}));}else{if(F.isObject(P)&&P.constructor.NAME==="node"){N=P;}else{return false;}}if(!L._vtbl.item.content){L._vtbl.item.content=N;}if(F.isUndefined(Q)){L._vtbl.items.push(N);M=L._vtbl.items.length-1;}else{if(!L._vtbl.items[Q]){L._vtbl.items[Q]=undefined;}L._vtbl.items.splice(Q,1,N);M=Q;}O=this.get("numItems");this.set("numItems",O+1);this.fire(C,{item:N,pos:M});return true;},addItems:function(M){var L=this,Q=false,O,N,P;if(!F.isArray(M)){return false;}Q=true;for(N=0,P=M.length;N<P;++N){O=M[N].content;if(!L.addItem(O,M[N].pos)){Q=false;}}return Q;},clearItems:function(){var L=this,M=L._vtbl.items;while(M.length>0){L.removeItem(0);}},getElementForItem:function(L){return this.getItem(L);},getElementForItems:function(L){return this.getItems(L);},getFirstVisible:function(){var L=this,N=L.get("numVisible"),M=L.get("selectedItem");return L._getFirstVisible(M,N);},getFirstVisibleOnPage:function(L){return(L-1)*this.get("numVisible");},getItem:function(M){var L=this;if(M<0||M>L._vtbl.items.length-1){return null;}return F.isUndefined(L._vtbl.items[M])?null:L._vtbl.items[M];},getItems:function(P){var M=this,L=[],N,O;if(F.isUndefined(P)){for(N=0,O=M._vtbl.items.length;N<O;++N){L[N]=M.getItem(N);}}else{for(N=0,O=P.length;N<O;++N){L[P[N]]=M.getItem(P[N]);}}return L;},getPageForItem:function(L){return Math.floor(L/this.get("numVisible"));},getVisibleItems:function(){var L=this,N=L.get("numVisible"),Q=L.getFirstVisible(),P=[],M,O;for(M=Q,O=Q+N;M<O;++M){P.push(L._vtbl.items[M]);}return P;},removeItem:function(M){var L=this,O,N;if(M<0||M>L._vtbl.items.length-1){return false;}O=L._vtbl.items.splice(M,1);if(!O){return false;}N=L.get("numItems");--N;L.set("numItems",N);this.fire(K,{item:O,pos:M});return true;},scrollBackward:function(){var M=this,L=M.get("scrollIncrement"),N=M.get("selectedItem");M.scrollTo(N-L);},scrollForward:function(){var M=this,L=M.get("scrollIncrement"),N=M.get("selectedItem");M.scrollTo(N+L);},scrollPageBackward:function(){var L=this,N=L.get("numVisible"),M=L.get("selectedItem");L.scrollTo(M-N);},scrollPageForward:function(){var L=this,N=L.get("numVisible"),M=L.get("selectedItem");L.scrollTo(M+N);},scrollTo:function(P){var O=this,N=O.get("isCircular"),Q=O.get("numItems"),M,L,S,R;if(P<0){if(N){P+=Q;}else{P=0;}}else{if(P>Q-1){if(N){P=Q-P;}else{P=Q-1;}}}R=O._getOffsetForIndex(P);L=O.get("contentBox");M=O.get("isVertical")?"top":"left";S=O.getFirstVisible();O.fire(I,{first:S,last:S+O.get("numVisible")});L.setStyle(M,R);S=O.getFirstVisible();O.fire(A,{first:S,last:S+O.get("numVisible")});O.set("selectedItem",P);},scrollToPage:function(M){var L=this;L.scrollTo(M*L.get("numVisible"));},bindUI:function(){var L=this,M=L.get("boundingBox");L.after("selectedItemChange",L._afterSelectedItemChange);if(!L.get("hidePagination")){M.delegate("click",B.bind(L._onNavItemClick,L),".yui3-carousel-nav-item > a");M.delegate("click",B.bind(L._onNavButtonClick,L),".yui3-carousel-button");}},initializer:function(){var L=this;L._vtbl={items:[],item:{content:null,hsz:0,vsz:0}};L.get("boundingBox").addClass(D(G.NAME,"loading"));L._parseItems();},renderUI:function(){var L=this;if(L.get("numItems")<1){L.get("boundingBox").addClass(D(G.NAME,"hidden"));return;}if(L._vtbl.item.hsz===0){L._vtbl.item.hsz=L._getNodeSize(L._vtbl.item.content,"width");}if(L._vtbl.item.vsz===0){L._vtbl.item.vsz=L._getNodeSize(L._vtbl.item.content,"height");}L._renderItems();if(!L.get("hidePagination")){L._renderNavigation();}L._renderContainer();},syncUI:function(){var L=this,M=L.get("selectedItem");L._uiSetSelectedItem(M,true);if(!L.get("hidePagination")){L._updateNavigation(M);}},_afterSelectedItemChange:function(M){var L=this;L._uiSetSelectedItem(M.prevVal,false);L._uiSetSelectedItem(M.newVal,true);L.fire(J,{pos:M.newVal});if(!L.get("hidePagination")){L._updateNavigation(M.newVal);}},_getFirstVisible:function(M,L){return M-(M%L);},_getOffsetForIndex:function(M){var L=this,N;N=L.get("isVertical")?L._vtbl.item.vsz:L._vtbl.item.hsz;return -N*M;},_getNodeSize:function(L,N){var M=0;if(L&&L.constructor.NAME==="node"){if(N==="height"){M=parseInt(L.getComputedStyle("marginTop"),10)+parseInt(L.getComputedStyle("paddingTop"),10)+parseInt(L.getComputedStyle("borderTopWidth"),10)+parseInt(L.getComputedStyle("height"),10)+parseInt(L.getComputedStyle("borderBottomWidth"),10)+parseInt(L.getComputedStyle("paddingBottom"),10)+parseInt(L.getComputedStyle("marginBottom"),10);}else{if(N=="width"){M=parseInt(L.getComputedStyle("marginLeft"),10)+parseInt(L.getComputedStyle("paddingLeft"),10)+parseInt(L.getComputedStyle("borderLeftWidth"),10)+parseInt(L.getComputedStyle("width"),10)+parseInt(L.getComputedStyle("borderRightWidth"),10)+parseInt(L.getComputedStyle("paddingRight"),10)+parseInt(L.getComputedStyle("marginRight"),10);}}}return M;},_onNavButtonClick:function(M){var L=this,N;M.preventDefault();N=M&&M.target?M.target:null;if(!N){return;}if(!N.test(".yui3-carousel-button")){N=N.ancestor();}if(N.hasClass("yui3-carousel-first-button")){L.scrollPageBackward();
}else{if(N.hasClass("yui3-carousel-next-button")){L.scrollPageForward();}}},_onNavItemClick:function(N){var L=this,M,O;N.preventDefault();O=N&&N.target?N.target:null;if(!O){return;}M=O.get("href");if(M){M=parseInt(M.replace(/.*#(.*)$/,"$1"),10);if(F.isNumber(M)){L.scrollToPage(M-1);L._uiSetNavItem(O.ancestor());}}},_parseItems:function(){var L,N,M=this;L=M.get("contentBox");N=L.all(M.get("carouselItemEl"));N.each(function(P,O){if(!M.addItem(P)){}},M);},_renderContainer:function(){var L=this,S=L.get("boundingBox"),O=L.get("hidePagination"),P=L.get("numVisible"),M=L.get("revealAmount"),N=0,R,Q;if(!O){R=S.one(".yui3-carousel-nav");N=L._getNodeSize(R,"height");}if(this.get("isVertical")){Q=L._vtbl.item.vsz*P;if(M>0){Q+=(Q*M/100);}L._uiSetHeight(Q+N);L._uiSetWidth(L._vtbl.item.vsz);L._uiSetWidthCB(L._vtbl.item.vsz);}else{Q=L._vtbl.item.hsz*P;if(M>0){Q+=(Q*M/100);}L._uiSetWidth(Q);L._uiSetHeight(L._vtbl.item.hsz+N);L._uiSetHeightCB(L._vtbl.item.hsz);}},_renderItems:function(){var N=this,M=N.get("contentBox"),L,P,R,Q,O;if(N.get("isVertical")){L="top";O=N._vtbl.item.vsz;}else{L="left";O=N._vtbl.item.hsz;}for(P=0,R=N._vtbl.items.length;P<R;++P){Q=N._vtbl.items[P];if(Q){if(!Q.inDoc()){if(P===0){M.appendChild(Q);}else{M.insertBefore(Q,N._vtbl.items[P-1]);}}Q.setStyle(L,O*P);}}},_renderNavigation:function(){var S=this,P=S.get("boundingBox"),N=S.get("contentBox"),Q=[],O,L,M,T,R;M=Math.ceil(S.get("numItems")/S.get("numVisible"));if(M<1){S.set("hidePagination",true);return;}T=S.get("strings.GOTO_PAGE");for(O=1;O<=M;++O){R=B.substitute(T,{page:O});Q.push(B.substitute(S.DEF_NAV_ITEM_TEMPLATE,{pagenum:O,label:R}));}S._navBtns={prev:B.guid(),next:B.guid()};L=E.create(B.substitute(S.DEF_NAV_TEMPLATE,{nav_items:Q.join(""),nav_prev_btn_id:S.prev,nav_prev_btn_text:S.get("strings.PREV_PAGE"),nav_next_btn_id:S.next,nav_next_btn_text:S.get("strings.NEXT_PAGE")}));P.insertBefore(L,N);},_setVertical:function(L,M){this._uiSetVertical(L);},_uiSetHeight:function(M){var L=this;if(M){L.get("boundingBox").setStyle("height",M);}},_uiSetHeightCB:function(M){var L=this;if(M){L.get("contentBox").setStyle("height",M);}},_uiSetNavItem:function(N){var L=this,O=L.get("boundingBox"),M;M=D(G.NAME,"nav-item-selected");O.all(".yui3-carousel-nav-item").removeClass(M);N.addClass(M);},_uiSetSelectedItem:function(N,L){var M=this,P=M._vtbl.items[N],O=D(G.NAME,"selected");if(P){if(L){P.addClass(O);}else{P.removeClass(O);}}},_uiSetVertical:function(M){var L=this.get("boundingBox");if(M){L.addClass(D(G.NAME,"vertical"));}else{L.addClass(D(G.NAME,"horizontal"));}},_uiSetWidth:function(M){var L=this;if(M){L.get("boundingBox").setStyle("width",M);}},_uiSetWidthCB:function(M){var L=this;if(M){L.get("contentBox").setStyle("width",M);}},_updateNavigation:function(P){var N=this,R=N.get("boundingBox"),M=N.get("isCircular"),O,Q,L;P=P||N.get("selectedItem");N._uiSetSelectedItem(P,true);L=R.all(".yui3-carousel-nav-item");Q=N.getPageForItem(P);N._uiSetNavItem(L.item(Q));if(P===0){O=R.one(".yui3-carousel-next-button");if(O){O.removeClass(".yui3-carousel-button-disabled");}if(!M){O=R.one(".yui3-carousel-first-button");if(O){O.addClass(".yui3-carousel-first-button-disabled");}}}else{if(P==N.get("numItems")-1){O=R.one(".yui3-carousel-first-button");if(O){O.removeClass(".yui3-carousel-first-button-disabled");}if(!M){O=R.one(".yui3-carousel-next-button");if(O){O.addClass(".yui3-carousel-button-disabled");}}}else{O=R.one(".yui3-carousel-first-button");if(O){O.removeClass(".yui3-carousel-first-button-disabled");}O=R.one(".yui3-carousel-next-button");if(O){O.removeClass(".yui3-carousel-button-disabled");}}}},_validateNumVisible:function(L,M){return L>0;},_validateRevealAmount:function(L,M){return L>=0&&L<=100;},ITEM_TEMPLATE:"<li>{content}</li>",DEF_NAV_TEMPLATE:'<div class="yui3-carousel-nav">'+"<ul>{nav_items}</ul>"+'<span class="yui3-carousel-button yui3-carousel-first-button">'+'<button type="button">'+"{nav_prev_btn_text}</button>"+"</span>"+'<span class="yui3-carousel-button yui3-carousel-next-button">'+'<button type="button">'+"{nav_next_btn_text}</button>"+"</span>"+"</div>",DEF_NAV_ITEM_TEMPLATE:'<li class="yui3-carousel-nav-item">'+'<a class="yui3-carousel-pager-item" '+'href="#{pagenum}"><em>{label}</em></a></li>',_navBtns:null,_vtbl:null});},"@VERSION@",{skinnable:true,requires:["widget"]});