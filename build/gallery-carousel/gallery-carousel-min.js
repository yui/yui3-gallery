YUI.add("gallery-carousel",function(B){function H(){H.superclass.constructor.apply(this,arguments);}var D=B.ClassNameManager.getClassName,G=B.Lang,F=B.Node,M=false,E=true,A="afterScroll",J="beforeScroll",C="itemAdded",L="itemRemoved",K="itemSelected",I="navStateChanged";H.NAME="carousel";H.ATTRS={autoPlayInterval:{validator:G.isNumber,value:0},carouselItemEl:{validator:G.isString,value:"li"},hidePagination:{validator:G.isBoolean,value:false},isCircular:{validator:G.isBoolean,value:false},isVertical:{setter:"_setVertical",validator:G.isBoolean,value:false},useMenuForNav:{validator:G.isBoolean,value:false},numItems:{value:0},numVisible:{validator:"_validateNumVisible",value:3},revealAmount:{validator:"_validateRevealAmount",value:0},scrollIncrement:{validator:G.isNumber,value:1},selectedItem:{validator:G.isNumber,value:0},strings:{value:{GOTO_PAGE:"Go to page {page}",NEXT_PAGE:"Next Page",PREV_PAGE:"Previous Page"}}};B.Carousel=B.extend(H,B.Widget,{addItem:function(R,S){var N=this,Q,O,P;if(G.isString(R)){P=F.create(B.substitute(N.ITEM_TEMPLATE,{content:R}));}else{if(G.isObject(R)&&R.constructor.NAME==="node"){P=R;}else{return false;}}if(!N._vtbl.item.content){N._vtbl.item.content=P;}if(G.isUndefined(S)){N._vtbl.items.push(P);O=N._vtbl.items.length-1;}else{if(!N._vtbl.items[S]){N._vtbl.items[S]=undefined;}N._vtbl.items.splice(S,1,P);O=S;}Q=this.get("numItems");this.set("numItems",Q+1);this.fire(C,{item:P,pos:O});return true;},addItems:function(O){var N=this,S=false,Q,P,R;if(!G.isArray(O)){return false;}S=true;for(P=0,R=O.length;P<R;++P){Q=O[P].content;if(!N.addItem(Q,O[P].pos)){S=false;}}return S;},clearItems:function(){var N=this,O=N._vtbl.items;while(O.length>0){N.removeItem(0);}},getElementForItem:function(N){return this.getItem(N);},getElementForItems:function(N){return this.getItems(N);},getFirstVisible:function(){var N=this,P=N.get("numVisible"),O=N.get("selectedItem");return N._getFirstVisible(O,P);},getFirstVisibleOnPage:function(N){return(N-1)*this.get("numVisible");},getItem:function(O){var N=this;if(O<0||O>N._vtbl.items.length-1){return null;}return G.isUndefined(N._vtbl.items[O])?null:N._vtbl.items[O];},getItems:function(R){var O=this,N=[],P,Q;if(G.isUndefined(R)){for(P=0,Q=O._vtbl.items.length;P<Q;++P){N[P]=O.getItem(P);}}else{for(P=0,Q=R.length;P<Q;++P){N[R[P]]=O.getItem(R[P]);}}return N;},getPageForItem:function(N){return Math.floor(N/this.get("numVisible"));},getVisibleItems:function(){var N=this,P=N.get("numVisible"),S=N.getFirstVisible(),R=[],O,Q;for(O=S,Q=S+P;O<Q;++O){R.push(N._vtbl.items[O]);}return R;},removeItem:function(O){var N=this,Q,P;if(O<0||O>N._vtbl.items.length-1){return false;}Q=N._vtbl.items.splice(O,1);if(!Q){return false;}P=N.get("numItems");--P;N.set("numItems",P);this.fire(L,{item:Q,pos:O});return true;},scrollBackward:function(){var O=this,N=O.get("scrollIncrement"),P=O.get("selectedItem");O.scrollTo(P-N);},scrollForward:function(){var O=this,N=O.get("scrollIncrement"),P=O.get("selectedItem");O.scrollTo(P+N);},scrollPageBackward:function(){var N=this,P=N.get("numVisible"),O=N.get("selectedItem");N.scrollTo(O-P);},scrollPageForward:function(){var N=this,P=N.get("numVisible"),O=N.get("selectedItem");N.scrollTo(O+P);},scrollTo:function(R){var Q=this,P=Q.get("isCircular"),S=Q.get("numItems"),O,N,U,T;if(R<0){if(P){R+=S;}else{R=0;}}else{if(R>S-1){if(P){R=S-R;}else{R=S-1;}}}T=Q._getOffsetForIndex(R);N=Q.get("contentBox");O=Q.get("isVertical")?"top":"left";U=Q.getFirstVisible();Q.fire(J,{first:U,last:U+Q.get("numVisible")});N.setStyle(O,T);U=Q.getFirstVisible();Q.fire(A,{first:U,last:U+Q.get("numVisible")});Q.set("selectedItem",R);},scrollToPage:function(O){var N=this;N.scrollTo(O*N.get("numVisible"));},bindUI:function(){var N=this,O=N.get("boundingBox");N.after("selectedItemChange",N._afterSelectedItemChange);if(!N.get("hidePagination")){O.delegate("click",B.bind(N._onNavItemClick,N),".yui3-carousel-nav-item > a");O.delegate("click",B.bind(N._onNavButtonClick,N),".yui3-carousel-button");}},initializer:function(){var N=this;N._vtbl={items:[],item:{content:null,hsz:0,vsz:0}};N.get("boundingBox").addClass(D(H.NAME,"loading"));N._parseItems();},renderUI:function(){var N=this;if(N.get("numItems")<1){N.get("boundingBox").addClass(D(H.NAME,"hidden"));return;}if(N._vtbl.item.hsz===0){N._vtbl.item.hsz=N._getNodeSize(N._vtbl.item.content,"width");}if(N._vtbl.item.vsz===0){N._vtbl.item.vsz=N._getNodeSize(N._vtbl.item.content,"height");}N._renderItems();if(!N.get("hidePagination")){N._renderNavigation();}N._renderContainer();},syncUI:function(){var N=this,O=N.get("selectedItem");N._uiSetSelectedItem(O,true);if(!N.get("hidePagination")){N._updateNavigation(O);}},_afterSelectedItemChange:function(O){var N=this;N._uiSetSelectedItem(O.prevVal,false);N._uiSetSelectedItem(O.newVal,true);N.fire(K,{pos:O.newVal});if(!N.get("hidePagination")){N._updateNavigation(O.newVal);}},_getFirstVisible:function(O,N){return O-(O%N);},_getOffsetForIndex:function(O){var N=this,P;P=N.get("isVertical")?N._vtbl.item.vsz:N._vtbl.item.hsz;return -P*O;},_getNodeSize:function(N,P){var O=0;if(N&&N.constructor.NAME==="node"){if(P==="height"){O=parseInt(N.getComputedStyle("marginTop"),10)+parseInt(N.getComputedStyle("paddingTop"),10)+parseInt(N.getComputedStyle("borderTopWidth"),10)+parseInt(N.getComputedStyle("height"),10)+parseInt(N.getComputedStyle("borderBottomWidth"),10)+parseInt(N.getComputedStyle("paddingBottom"),10)+parseInt(N.getComputedStyle("marginBottom"),10);}else{if(P=="width"){O=parseInt(N.getComputedStyle("marginLeft"),10)+parseInt(N.getComputedStyle("paddingLeft"),10)+parseInt(N.getComputedStyle("borderLeftWidth"),10)+parseInt(N.getComputedStyle("width"),10)+parseInt(N.getComputedStyle("borderRightWidth"),10)+parseInt(N.getComputedStyle("paddingRight"),10)+parseInt(N.getComputedStyle("marginRight"),10);}}}return O;},_onNavButtonClick:function(O){var N=this,P;O.preventDefault();P=O&&O.target?O.target:null;if(!P){return;}if(!P.test(".yui3-carousel-button")){P=P.ancestor();}if(P.hasClass("yui3-carousel-first-button")){if(M){N.scrollPageBackward();
}}else{if(P.hasClass("yui3-carousel-next-button")){if(E){N.scrollPageForward();}}}},_onNavItemClick:function(P){var N=this,O,Q;P.preventDefault();Q=P&&P.target?P.target:null;if(!Q){return;}O=Q.get("href");if(O){O=parseInt(O.replace(/.*#(.*)$/,"$1"),10);if(G.isNumber(O)){N.scrollToPage(O-1);N._uiSetNavItem(Q.ancestor());}}},_parseItems:function(){var P=this,N,O;N=P.get("contentBox");O=N.all(P.get("carouselItemEl"));O.each(function(R,Q){if(!P.addItem(R)){}},P);},_renderContainer:function(){var N=this,U=N.get("boundingBox"),Q=N.get("hidePagination"),R=N.get("numVisible"),O=N.get("revealAmount"),P=0,T,S;if(!Q){T=U.one(".yui3-carousel-nav");P=N._getNodeSize(T,"height");}if(this.get("isVertical")){S=N._vtbl.item.vsz*R;if(O>0){S+=(S*O/100);}N._uiSetHeight(S+P);N._uiSetWidth(N._vtbl.item.vsz);N._uiSetWidthCB(N._vtbl.item.vsz);}else{S=N._vtbl.item.hsz*R;if(O>0){S+=(S*O/100);}N._uiSetWidth(S);N._uiSetHeight(N._vtbl.item.hsz+P);N._uiSetHeightCB(N._vtbl.item.hsz);}},_renderItems:function(){var P=this,O=P.get("contentBox"),N,R,T,S,Q;if(P.get("isVertical")){N="top";Q=P._vtbl.item.vsz;}else{N="left";Q=P._vtbl.item.hsz;}for(R=0,T=P._vtbl.items.length;R<T;++R){S=P._vtbl.items[R];if(S){if(!S.inDoc()){if(R===0){O.appendChild(S);}else{O.insertBefore(S,P._vtbl.items[R-1]);}}S.setStyle(N,Q*R);}}},_renderNavigation:function(){var U=this,R=U.get("boundingBox"),P=U.get("contentBox"),S=[],Q,N,O,V,T;O=Math.ceil(U.get("numItems")/U.get("numVisible"));if(O<1){U.set("hidePagination",true);return;}V=U.get("strings.GOTO_PAGE");for(Q=1;Q<=O;++Q){T=B.substitute(V,{page:Q});S.push(B.substitute(U.DEF_NAV_ITEM_TEMPLATE,{pagenum:Q,label:T}));}U._navBtns={prev:B.guid(),next:B.guid()};N=F.create(B.substitute(U.DEF_NAV_TEMPLATE,{nav_items:S.join(""),nav_prev_btn_id:U.prev,nav_prev_btn_text:U.get("strings.PREV_PAGE"),nav_next_btn_id:U.next,nav_next_btn_text:U.get("strings.NEXT_PAGE")}));R.insertBefore(N,P);},_setVertical:function(N,O){this._uiSetVertical(N);},_uiSetHeight:function(O){var N=this;if(O){N.get("boundingBox").setStyle("height",O);}},_uiSetHeightCB:function(O){var N=this;if(O){N.get("contentBox").setStyle("height",O);}},_uiSetNavItem:function(P){var N=this,Q=N.get("boundingBox"),O;O=D(H.NAME,"nav-item-selected");Q.all(".yui3-carousel-nav-item").removeClass(O);P.addClass(O);},_uiSetSelectedItem:function(P,N){var O=this,R=O._vtbl.items[P],Q=D(H.NAME,"selected");if(R){if(N){R.addClass(Q);}else{R.removeClass(Q);}}},_uiSetVertical:function(O){var N=this.get("boundingBox");if(O){N.addClass(D(H.NAME,"vertical"));}else{N.addClass(D(H.NAME,"horizontal"));}},_uiSetWidth:function(O){var N=this;if(O){N.get("boundingBox").setStyle("width",O);}},_uiSetWidthCB:function(O){var N=this;if(O){N.get("contentBox").setStyle("width",O);}},_updateNavigation:function(T){var Q=this,U=Q.get("boundingBox"),P=Q.get("isCircular"),R,O,S,N;T=T||Q.get("selectedItem");Q._uiSetSelectedItem(T,true);N=U.all(".yui3-carousel-nav-item");O=Q.getPageForItem(T);Q._uiSetNavItem(N.item(O));S=Q.getPageForItem(Q.get("numItems")-1);if(T===0){R=U.one(".yui3-carousel-next-button");if(R){R.removeClass(".yui3-carousel-button-disabled");E=true;}if(!P){R=U.one(".yui3-carousel-first-button");if(R){R.addClass(".yui3-carousel-first-button-disabled");M=false;}}}else{if(O==S){R=U.one(".yui3-carousel-first-button");if(R){R.removeClass(".yui3-carousel-first-button-disabled");M=true;}if(!P){R=U.one(".yui3-carousel-next-button");if(R){R.addClass(".yui3-carousel-button-disabled");E=false;}}}else{R=U.one(".yui3-carousel-first-button");if(R){R.removeClass(".yui3-carousel-first-button-disabled");M=true;}R=U.one(".yui3-carousel-next-button");if(R){R.removeClass(".yui3-carousel-button-disabled");E=true;}}}},_validateNumVisible:function(N,O){return N>0;},_validateRevealAmount:function(N,O){return N>=0&&N<=100;},ITEM_TEMPLATE:"<li>{content}</li>",DEF_NAV_TEMPLATE:'<div class="yui3-carousel-nav">'+"<ul>{nav_items}</ul>"+'<span class="yui3-carousel-button yui3-carousel-first-button">'+'<button type="button">'+"{nav_prev_btn_text}</button>"+"</span>"+'<span class="yui3-carousel-button yui3-carousel-next-button">'+'<button type="button">'+"{nav_next_btn_text}</button>"+"</span>"+"</div>",DEF_NAV_ITEM_TEMPLATE:'<li class="yui3-carousel-nav-item">'+'<a class="yui3-carousel-pager-item" '+'href="#{pagenum}"><em>{label}</em></a></li>',_navBtns:null,_vtbl:null});},"@VERSION@",{skinnable:true,requires:["widget"]});