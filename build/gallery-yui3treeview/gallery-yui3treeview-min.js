YUI.add("gallery-yui3treeview",function(b){var d=b.ClassNameManager.getClassName,e="treeview",k="tree",c="treeleaf",j="contentBox",i="boundingBox",g="innerHTML",l={},f=true,h=false,a={loading:d(e,"loading"),tree:d(k),treeLabel:d(e,"treelabel"),labelcontent:d(e,"label-content"),treeview:d(e),collapsed:d(k,"collapsed"),leaf:d(c)};b.TreeView=b.Base.create("treeview",b.Widget,[b.WidgetParent,b.WidgetChild],{initializer:function(m){this.after("parentChange",this._onParentChange,this);this.publish("toggleTreeState",{defaultFn:this._toggleTreeState});l[b.stamp(this.get(i))]=this;},_renderFromMarkup:h,_onParentChange:function(){var q=this.get("depth")>-1,u=q?"<li></li>":"<div></div>",n,p=this.get(i),s,r,m,t=this.getClassName("treelabel"),o;if(this._renderFromMarkup){s=p.one(":first-child");s.set("role","treeitem");s.addClass(t);r=s.get(g);m=b.substitute(this.EXPANDCONTROL_TEMPLATE,{labelcontentClassName:a.labelcontent,label:r});s.set(g,m);this.set("label",r);this._renderFromMarkup=h;}else{r=this.get("label");n=b.substitute(this.TREEVIEWLABEL_TEMPLATE,{treelabelClassName:t});n=b.Node.create(n);m=b.substitute(this.EXPANDCONTROL_TEMPLATE,{labelcontentClassName:a.labelcontent,label:r});n.append(m);this._set(j,b.Node.create("<ul></ul>"));this._set(i,b.Node.create(u));p=this.get(i).setContent(n);l[b.stamp(p)]=this;}p.set("role","presentation");},CONTENT_TEMPLATE:"<div></div>",BOUNDING_TEMPLATE:"<ul></ul>",TREEVIEWLABEL_TEMPLATE:"<a class={treelabelClassName} role='treeitem' href='#'></a>",EXPANDCONTROL_TEMPLATE:"<span class={labelcontentClassName}>{label}</span>",bindUI:function(){var n,m;if(this.isRoot()){n=this.get(i);m=this.get(j);n.on("click",this.onViewEvents,this);n.on("keydown",this.onViewEvents,this);n.plug(b.Plugin.NodeFocusManager,{descendants:".yui3-treeleaf-content, .yui3-treeview-treelabel",keys:{next:"down:40",previous:"down:38"},circular:true});}},renderUI:function(){if(!this.isRoot()){this.get(i).addClass(a.collapsed);}var n=this.get("srcNode"),m=this._items;if(m.length===1&&(m[0] instanceof b.TreeView)){m[0].get(i).addClass("yui3-singletree");}},_toggleTreeState:function(n){var m=n.actionNode.ancestor("."+a.treeview);m.toggleClass(a.collapsed);},_collapseTree:function(n){var m=n.ancestor("."+a.treeview);if(!m.hasClass(a.collapsed)){m.toggleClass(a.collapsed);}},_expandTree:function(n){var m=n.ancestor("."+a.treeview);if(m.hasClass(a.collapsed)){m.toggleClass(a.collapsed);}},onViewEvents:function(q){var s=q.target,m=q.keyCode,o,p,n,r;o=s.get("className").split(" ");r=o.length;q.preventDefault();for(n=0;n<r;n++){p=o[n];switch(p){case a.labelcontent:this.fire("toggleTreeState",{actionNode:s});break;case a.treeLabel:if(m===39){this._expandTree(s);}else{if(m===37){this._collapseTree(s);}}break;}}}},{NAME:"treeview",ATTRS:{defaultChildType:{value:"TreeLeaf",readOnly:f},label:{validator:b.Lang.isString},loadOnDemand:{value:null}},HTML_PARSER:{children:function(q){var m=q.all("> li"),p=q.ancestor("ul"),o,n=[];if(m.size()>0||p){this._renderFromMarkup=true;}else{this.CONTENT_TEMPLATE=null;}m.each(function(r){var t=r.one(":first-child"),s={srcNode:t,boundingBox:r,contentBox:t,type:null};o=r.one("> ul");if(o){s.type="TreeView";s.contentBox=o;s.srcNode=o;}n.push(s);});return n;}}});b.TreeLeaf=b.Base.create("treeleaf",b.Widget,[b.WidgetChild],{CONTENT_TEMPLATE:"<span></span>",BOUNDING_TEMPLATE:"<li></li>",initializer:function(){l[b.stamp(this.get(i))]=this;},renderUI:function(){this.get(j).setContent(this.get("label"));this.get(i).set("role","treeitem");}},{NAME:"TreeLeaf",ATTRS:{label:{validator:b.Lang.isString},tabIndex:{value:-1}},HTML_PARSER:{label:function(m){return m.get(g);}}});},"gallery-2011.01.03-18-30",{requires:["substitute","widget","widget-parent","widget-child","node-focusmanager"]});