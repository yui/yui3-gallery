YUI.add("gallery-resize",function(B){var A=function(C){A.superclass.constructor.apply(this,arguments);};A.NAME="resizePlugin";A.NS="resize";A.ATTRS={animate:{value:false,validator:function(C){return B.Lang.isNumber(C);}},animateDuration:{value:0.25},animateEasing:{value:(B.Easing===undefined?null:B.Easing.easeNone)},autoRatio:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},draggable:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},ghost:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},handles:{value:["r","br","b"],setter:function(C){if(B.Lang.isString(C)&&C.toLowerCase()=="all"){return["t","b","r","l","bl","br","tl","tr"];}}},height:{lazyAdd:false,setter:function(C){this.get("host").setStyle("height",C+"px");return C;},validator:function(C){return B.Lang.isNumber(C);}},hiddenHandles:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},hover:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},knobHandles:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},maxHeight:{validator:function(C){return B.Lang.isNumber(C);}},maxWidth:{validator:function(C){return B.Lang.isNumber(C);}},maxX:{validator:function(C){return B.Lang.isNumber(C);}},maxY:{validator:function(C){return B.Lang.isNumber(C);}},minHeight:{validator:function(C){return B.Lang.isNumber(C);}},minWidth:{validator:function(C){return B.Lang.isNumber(C);}},minX:{validator:function(C){return B.Lang.isNumber(C);}},minY:{validator:function(C){return B.Lang.isNumber(C);}},proxy:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},ratio:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},setSize:{},status:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},useShim:{value:false,validator:function(C){return B.Lang.isBoolean(C);}},width:{lazyAdd:false,setter:function(C){this.get("host").setStyle("width",C+"px");return C;},validator:function(C){return B.Lang.isNumber(C);}},wrappedEls:{value:false,lazyAdd:false,validator:function(C){return B.Lang.isString(C);},setter:function(C){if(C){this._wrappedEls=B.Array(B.all("#"+this.get("host").get("id")+" "+C));}}},hugWrappedEl:{value:false,lazyAdd:false,setter:function(F){if(this._wrappedEls!==undefined&&this._wrappedEls.length==1&&F===true){var G=this._wrappedEls[0],D=this.get("host"),C=parseInt(G.getComputedStyle("height")||G.getAttribute("height"),10),E=parseInt(G.getComputedStyle("width")||G.getAttribute("width"),10);if(G.getStyle("position")=="absolute"){D.setXY(G.getXY());}if(B.UA.ie){C+=8;E+=5;}D.setStyle("width",E+"px");D.setStyle("height",C+"px");}}},xTicks:{validator:function(C){return B.Lang.isNumber(C);}},yTicks:{validator:function(C){return B.Lang.isNumber(C);}}};B.extend(A,B.Plugin.Base,{_currentHandle:false,_locked:false,_ratioValue:null,_resizeNode:null,_originalPosition:{},_statusNode:false,_wrappedEls:[],initializer:function(C){switch(this.get("host").get("nodeName").toLowerCase()){case"textarea":case"img":case"input":case"iframe":case"select":return false;}this._renderHandles();this._renderStatus();this._addDD();},_renderHandles:function(){var F=this.get("host"),D=F.getAttribute("id"),E=this.get("hover"),C,H,G;G=function(I){return B.Node.create("<div></div>").addClass("yui3-resize-handle").addClass("yui3-resize-handle-"+I).append(B.Node.create("<div></div>").addClass("yui3-resize-handle-inner-"+I));};B.each(this.get("handles"),function(J,I){F.append(G(J,I));});C=function(){B.each(this.getAttribute("class").split(" "),function(I,J){this.addClass(I+"-active");},this);if(E){F.removeClass("yui3-resize-hover");}};H=function(){B.each(this.getAttribute("class").split(" "),function(I,J){if(I.slice(-7)=="-active"){this.removeClass(I);}},this);if(E){F.addClass("yui3-resize-hover");}};B.on("mouseenter",C,"#"+D+" .yui3-resize-handle");B.on("mouseleave",H,"#"+D+" .yui3-resize-handle");F.addClass("yui3-resize");if(this.get("hiddenHandles")){F.addClass("yui3-resize-hidden");}if(E){F.addClass("yui3-resize-hover");}if(this.get("knobHandles")){F.addClass("yui3-resize-knob");}},_renderStatus:function(){if(this.get("status")){this._statusNode=B.Node.create('<span class="yui3-resize-status"></span>');B.Node.one("body").prepend(this._statusNode);}},_addDD:function(){var C=this.get("host");C.plug(B.Plugin.Drag,{useShim:this.get("useShim")});if(this.get("proxy")){C.dd.plug(B.Plugin.DDProxy,{moveOnEnd:true});this._resizeNode=B.DD.DDM._proxy;}else{this._resizeNode=C;}C.dd.addHandle(".yui3-resize-handle");C.dd.on("drag:start",this._startResize,this);C.dd.on("drag:drag",this._resize,this);C.dd.on("drag:end",this._endResize,this);if(this.get("draggable")){C.dd.addHandle(C);}},_startResize:function(E){var D=this.get("host"),C=D.dd.get("activeHandle");if(C===undefined||!C.hasClass("yui3-resize-handle")){if(this.get("draggable")){D.dd.set("move",true);}return;}this._currentHandle=C;if(this.get("ratio")||(this.get("autoRatio")&&E.currentTarget._ev_md.shiftKey)){this._ratioValue=parseInt(D.getComputedStyle("height"),10)/parseInt(D.getComputedStyle("width"),10);}if(this.get("ghost")){D.addClass("yui3-resize-ghost");}this._originalPosition=this._getPosition(this._resizeNode);this._startChildResize();this._showStatus();},_startChildResize:function(){},_resize:function(L){if(this._locked===true||this._currentHandle===false){return;}var M=this._getPosition(this._resizeNode),N=this._originalPosition,O=M.w,I=M.h,Q=M.t,G=M.l,E=L.info.delta[0],J=L.info.delta[1],K=0,H=0,P=0,F=0,D=this._currentHandle,C;if(this._resizeNode.getStyle("position")!=="absolute"){N.t=0;Q=0;N.l=0;G=0;}if(this.get("xTicks")&&this.get("xTicks")>0){K=this._snapTick(E,this.get("xTicks"));}if(this.get("yTicks")&&this.get("yTicks")>0){H=this._snapTick(J,this.get("yTicks"));}if(D.hasClass("yui3-resize-handle-r")){K=E;Q=N.t;G=N.l;}else{if(D.hasClass("yui3-resize-handle-l")){K=-E;F=E;Q=N.t;}else{if(D.hasClass("yui3-resize-handle-t")){H=-J;P=J;G=N.l;}else{if(D.hasClass("yui3-resize-handle-b")){H=J;G=N.l;Q=N.t;}else{if(D.hasClass("yui3-resize-handle-tl")){K=-E;
F=E;H=-J;P=J;}else{if(D.hasClass("yui3-resize-handle-tr")){K=E;H=-J;P=J;G=N.l;}else{if(D.hasClass("yui3-resize-handle-bl")){K=-E;H=J;F=E;Q=N.t;}else{if(D.hasClass("yui3-resize-handle-br")){K=E;H=J;Q=N.t;P=0;G=N.l;F=0;}}}}}}}}C=this._constrainResize({w:O+K,h:I+H,t:Q+P,l:G+F});this._setPosition(C,this._resizeNode);this._updateStatus(L,{w:O+K,h:I+H,dw:E,dh:J});this._resizeChildren(B.mix({ratioW:K/O,ratioH:H/I,dl:F,dt:P},C));L.halt(true);},_resizeChildren:function(C){if(this._wrappedEls===false){return;}if(this._wrappedEls.length==1){this._setPosition({w:C.w,h:C.h,t:C.t,l:C.l},this._wrappedEls[0]);return;}var D=function(F){var E=this._getPosition(F);this._setPosition({w:E.w*(1+C.ratioW),h:E.h*(1+C.ratioH),t:E.t+C.dt,l:E.l+C.dl},F);};B.each(this._wrappedEls,D,this);},_endResize:function(C){if(this.get("draggable")&&this._currentHandle!==false){this.get("host").dd.set("move",false);}if(this.get("proxy")&&this._currentHandle!==false){if(this.get("animate")){this._animPosition(this._getPosition(this._resizeNode));}else{this._setPosition(this._getPosition(this._resizeNode));}}this._currentHandle=false;this._ratioValue=null;if(this.get("ghost")){this.get("host").removeClass("yui3-resize-ghost");}this._hideStatus();},_getPosition:function(C){if(C===undefined){C=this.get("host");}return{w:parseInt(C.getStyle("width"),10),h:parseInt(C.getStyle("height"),10),t:parseInt(C.getY(),10),l:parseInt(C.getX(),10)};},_setPosition:function(C,D){if(D===undefined){D=this.get("host");}D.setStyle("width",parseInt(C.w,10)+"px");D.setStyle("height",parseInt(C.h,10)+"px");D.setStyle("top",parseInt(C.t,10)+"px");D.setStyle("left",parseInt(C.l,10)+"px");},_animPosition:function(D,E){if(B.Anim===undefined){return this._setPosition(D,E);}this._setPosition(this._originalPosition,this.get("host"));if(E===undefined){E=this.get("host");}var C=new B.Anim({node:E,from:this._originalPosition,to:{width:D.w,height:D.h,left:D.l,top:D.t},easing:this.get("animEasing"),duration:this.get("animDuration")});C.run();},_showStatus:function(){if(!this.get("status")){return;}this._statusNode.setStyle("display","inline");},_updateStatus:function(C,E){if(!this.get("status")){return;}var D=this._statusNode;D.setContent("<strong>"+E.w+" x "+E.h+"</strong><em>"+(E.w-this._originalPosition.w)+" x "+(E.h-this._originalPosition.h)+"</em>");D.setXY([C.target.mouseXY[0]+12,C.target.mouseXY[1]+12]);},_hideStatus:function(){if(!this.get("status")){return;}this._statusNode.setContent("");this._statusNode.setStyle("display","none");},_constrainResize:function(E){var G=E.w,D=E.h,C=E.t,F=E.l;if(this.get("minX")&&F<this.get("minX")){F=this.get("minX");}if(this.get("minY")&&C<this.get("minY")){C=this.get("minY");}if(this.get("maxX")&&F>this.get("maxX")){F=this.get("maxX");}if(this.get("maxY")&&C>this.get("maxY")){C=this.get("maxY");}if(this.get("minHeight")&&D<this.get("minHeight")){D=this.get("minHeight");}if(this.get("minWidth")&&G<this.get("minWidth")){G=this.get("minWidth");}if(this.get("maxHeight")&&D>this.get("maxHeight")){D=this.get("maxHeight");}if(this.get("maxWidth")&&G>this.get("maxWidth")){G=this.get("maxWidth");}if((this.get("ratio")===true||this.get("autoRatio"))&&(this._ratioValue>0)){D=G*this._ratioValue;}return{w:G,h:D,t:C,l:F};},_snapTick:function(E,D){if(!E||!D){return E;}var F=E,C=Math.abs(E%D);if(Math.abs(C)>(D/2)){F=E+(D-C);}else{F=E-C;}return F;},destructor:function(){this.get("host").dd.destroy();this.get("host").unplug("dd");this.detachAll();B.all("#"+this.get("host").get("id")+" .yui3-resize-handle").each(function(C){C.remove();});if(this._statusNode!==false){this._statusNode.remove();}this.get("host").removeClass("yui3-resize").removeClass("yui3-resize-hover").removeClass("yui3-resize-knob").removeClass("yui3-resize-hidden");},getActiveHandleEl:function(){return this._currentHandle;},getProxyEl:function(){if(this.get("proxy")){return B.DD.DDM._proxy;}return false;},getStatusEl:function(){return this._statusNode;},getWrapEl:function(){return false;},isActive:function(){return this._currentHandle===false?false:true;},isLocked:function(){return this._locked;},lock:function(){this._locked=true;if(this.get("host").dd){this.get("host").dd.lock();}},unlock:function(){this._locked=false;if(this.get("host").dd){this.get("host").dd.unlock();}},reset:function(){},toString:function(){return"Resize plugin "+this.get("host").getAttribute("id");}});B.Plugin.Resize=A;},"gallery-2010.05.21-18-16",{requires:["attribute","node","plugin","dd-plugin","dd-proxy","anim","event-mouseenter"]});