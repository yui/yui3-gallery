YUI.add("gallery-composite-image",function(a){(function(f){var e=f.namespace("Composite"),c,d,b;b=function(g){b.superclass.constructor.call(this,g);};b.ATTRS={channels:{value:[{maximum:255,minimum:0,mode:"i"},{maximum:255,minimum:0,mode:"i"},{maximum:255,minimum:0,mode:"i"},{maximum:1,minimum:0,mode:"f"}],writeOnce:"initOnly"},dimensions:{value:[512,512],writeOnce:"initOnly"},pixelCount:{readOnly:true}};b.NAME="Composite-Image";f.extend(b,f.Base,{clear:function(){var h=this,g=[];g.length=h._pixelData.length;h._pixelData=g;return h;},clone:function(){var h=this,g=new b({channels:h.get("channels"),dimensions:h.get("dimensions")});g._pixelData=h._pixelData.slice();return g;},eachPixel:function(n,m,j){var r=n.ctx,q=n.fn,o=this,p=n.pch,h=o.get("pixelCount"),k=f.clone(o.get("channels")),g=o.get("dimensions").slice(),i=c.apply(o,g),l;l=function(s){if(s>=h){m.call(j,{chs:k,dims:g,img:this,pcnt:h,pix:s});return;}f.later(0,this,function(){var t=i(s),u=this;if(q.call(r,{at:t,chs:k,dims:g,img:u,pch:p,pcnt:h,pix:s,pxl:u.getPixel(t,p)})){m.call(j,{chs:k,dims:g,img:u,pcnt:h,pix:s});}else{l.call(u,s+1);}});};l.call(o,0);return o;},getAt:function(g){return c.apply(this,this.get("dimensions"))(g);},getPixel:function(g,i){var l=this,k=l._pixelData,j,h=l.get("channels.length");j=d.apply(l,l.get("dimensions"))(g)*h;if(i){return(function(q,o){var p,n=[],m;for(p=0,m=i.length;p<m;p+=1){n[p]=q[o+i[p]];}return n;}(k,j));}return k.slice(j,j+h);},getPixelIndex:function(g){return d.apply(this,this.get("dimensions"))(g);},initializer:function(){var k=this,h=k.get("channels"),j=k.get("dimensions"),g=1,i=[];if(!h.length){throw"Image must have at least one channel.";}if(!j.length){throw"Image must have at least one dimension.";}f.each(h,function(l){l.blackValue=l.blackValue||0;l.whiteValue=l.whiteValue||(l.mode==="i"?255:1);});f.each(j,function(l){if(l<=0){throw"Dimension must have at least 1 pixel.";}g*=l;});k._set("pixelCount",g);i.length=g*h.length;this._pixelData=i;},setPixel:function(h,g,n){var k,m=this,p,q=m._pixelData,j,l=m.get("channels"),o=l.length;j=d.apply(m,m.get("dimensions"))(h)*o;if(n){for(k=0,p=n.length;k<p;k+=1){q[j+n[k]]=b.conformChannelValue(g[k],l[n[k]]);}}else{for(k=0;k<o;k+=1){q[j+k]=b.conformChannelValue(g[k],l[k]);}}return this;}},{conformChannelValue:function(h,g){h=+h||0;if(g.maximum){h=Math.min(h,g.maximum);}if(g.minimum){h=Math.max(h,g.minimum);}if(g.mode==="i"){h=Math.round(h);}return h;}});c=f.cached(function(){var g=arguments,i=Math.floor,h=g.length;return f.cached(function(o){var k=[o%g[0]],m,l,n;for(m=1;m<h;m+=1){n=1;for(l=0;l<m;l+=1){n*=g[l];}k[m]=i(o/n)%m;}return k;});});d=f.cached(function(){var g=arguments,h=g.length;return f.cached(function(){var k=arguments,n,m=0,l,o;for(n=0;n<h;n+=1){o=k[n];for(l=n-1;l>0;l-=1){o*=g[l];}m+=o;}return m;});});e.Image=b;}(a));},"gallery-2012.06.20-20-07",{requires:["base"],skinnable:false});