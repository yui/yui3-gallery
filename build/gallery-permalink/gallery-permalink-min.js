YUI.add("gallery-permalink",function(a){a.Permalink=a.Base.create("permalink",a.Widget,[a.WidgetStack],{renderUI:function(){var b=this.get("contentBox");var d=this._renderAnchor();b.appendChild(d);var c=this.get("boundingBox");c.setStyle("position","relative");var f=this.get("left");var e=this.get("top");if(!f){f=0;}if(!e){e=0;}c.setStyle("left",f+"px");c.setStyle("top",e+"px");},bindUI:function(){a.Permalink.superclass.bindUI.apply(this,arguments);var b=this.get("contentBox");a.delegate("mouseover",a.bind(this.get("linkGenerator"),this),b,"a");},_handleClick:function(d){d.preventDefault();var c=d.target;if(!c.hasAttribute("href")){c=c.get("parentNode");}var b=c.get("href");if(document.all){window.external.AddFavorite(b,document.title);}else{if(window.sidebar){window.sidebar.addPanel(document.title,b,"");}}},_getDefaultLinkGenerator:function(c){if(!this.base){this.base=window.location.href;}var b=function(){var d=this.get("anchor");var e=c?c():this.base;d.set("href",e);d.blur();d.focus();};return b;},_renderAnchor:function(){var d=decodeURIComponent(window.location.href);if(d.indexOf("?")!=-1){d=d.substring(0,d.indexOf("?"));}var c=this.get("label");var b;if(!c){c="Permalink";}b=a.Node.create('<a href="'+d+'">'+c+"</a>");b.setStyle("text-align","center");this.set("anchor",b);b.on("click",this._handleClick);return b;}},{ATTRS:{label:null,left:null,top:null,linkGenerator:{valueFn:"_getDefaultLinkGenerator",setter:function(b){return this._getDefaultLinkGenerator(b);}}}});},"gallery-2011.11.30-20-58",{requires:["widget","widget-stack"],skinnable:false});