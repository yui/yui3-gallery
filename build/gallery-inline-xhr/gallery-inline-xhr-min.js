YUI.add("gallery-inline-xhr",function(e){var F="inlineXHR",m={mode:null,url:null,method:"POST"},q={},u=0,d="Executing",x="method",C="ResponseText",H="undefined",G=" ",k="#",y="is empty",h="in",n="error",f="info",z="alert",j="not found",A="HTML",l="cursor",B="JSON syntax error in responseText: ",b=function(I,J){if(J===n&&m.mode===z){window.alert(I);}},w=function(L,J,I,K){if(e[L]===undefined){return false;}else{b(d+G+x+" of Y : "+L,f);J.push(I,K);e[L].apply(e,J);return true;}},i=function(L,J,I,K){if(q===undefined){return false;}if(q[L]!==undefined){b(d+" private"+G+x+" : "+L,f);J.push(I,K);q[L].apply(q,J);return true;}else{return false;}},t=function(J,I){b("Error response received from server: "+J+": "+I,n);},o=function(R,K){if(K.responseText!==undefined){if(K.responseText.length===0){b(C+G+y+".",n);return;}try{var L=e.JSON.parse(K.responseText),Q,J,M,I,N,P;if(L.c!==200){Q=L.c;J=L.t;t(Q,J);}else{try{for(M in L.ff){if(L.ff.hasOwnProperty(M)){I=L.ff[M];N=I.f;P=I.a;if(!w(N,P,R,K)){if(!i(N,P,R,K)){b(x+" '"+N+"' "+j+" in Y or "+F,n);}}}}}catch(O){b(n+G+O,n);return;}}}catch(O){b(B+K.responseText+G+h+G+F+" "+O,n);return;}}else{b(C+G+H+G+h+G+F,n);}},c=function(){u++;},v=function(){u--;},r=function(){return u;},D=function(){c();e.one(A).setStyle(l,"wait");e.all("input").each(function(I){I.setStyle(l,"wait");});},E=function(){v();if(0===r()){e.one(A).setStyle(l,"default");e.all("input").each(function(I){I.setStyle(l,"default");});}},s=function(I,K){var J="Failure for xhr Id: "+I+".\n";J+="HTTP status: "+K.status+"\n";J+="HTTP headers received: "+K.getAllResponseHeaders()+"\n";J+="Status code message: "+K.statusText+".";b(J,n);},g=function(){var I;for(I in this){if(this.hasOwnProperty(I)&&I!=="request"){this[I]();}}},p=function(I){I=I||{};if(undefined===I.request){I.request=g;}return I;},a=function(){a.superclass.constructor.apply(this,arguments);};a.NAME=F;e.extend(a,e.Base,{register:function(K,M,J,L){var I=this;K=p(K);K[M]=function(){m.url=m.url?m.url:document.location.href.replace(document.location.hash,"");var O=null,N;if(L!==undefined){O={id:e.one(L),useDisabled:false};}N=e.io(m.url,{method:m.method,data:J+"&ajaxAction="+M,form:O,on:{success:o,failure:s,start:D,complete:E,end:e.bind(I._onEnd,I)},arguments:{end:M}});};return K;},_getEndCb:function(I){return this._endCallBacks.funcs[I];},_getEndCbArgs:function(I){return this._endCallBacks.args[I];},_getEndCbContext:function(I){return this._endCallBacks.contexts[I];},_onEnd:function(){var L=arguments[1].end,K=this._getEndCb(L),I=this._getEndCbArgs(L),J=this._getEndCbContext(L)||this;if(e.Lang.isFunction(K)){this._endCallBacks.results[L]=K.apply(J,I);}},_endCallBacks:{args:{},funcs:{},contexts:{},results:{}},_clearEndCallBack:function(I){this._endCallBacks.contexts[I]=null;this._endCallBacks.funcs[I]=null;this._endCallBacks.args[I]=null;this._endCallBacks.results[I]=null;},after:function(L,J){var I=e.Array(arguments);if(I.length<2){b("Missing mandatory arguments to inlineXHR::after."+L,n);}I.splice(0,2);var K=I.shift();this._endCallBacks.contexts[L]=K;this._endCallBacks.funcs[L]=J;this._endCallBacks.args[L]=I;},getAfter:function(J){var I=this._endCallBacks.results[J];this._clearEndCallBack(J);return I;},wizard:function(K){var O=K.fnName,I=K.tag,L,M=K.start?null:this.getAfter(O),J=[L,O,M],N=K.formId?k+K.formId:null;if(N){J.push(N);}L=this.register.apply(this,J);if(I){this.after(O,function(P){M=e.one(k+P).get("value");return M;},this,I);}return L;},header:function(I,J){e.io.header.apply(e,arguments);},usePrivate:function(J,I){q[I]=J;b("Registering for use private func: "+I+" on inlinexhr object.",f);},setConfig:function(I){var J;for(J in I){if(I.hasOwnProperty(J)){if(m[J]===undefined){b("Wrong configuration parameter passed to xhr object: "+J,n);}b("Setting : '"+J+"' to '"+I[J]+"'",f);m[J]=I[J];}}},startSpinner:function(){e.one(A).setStyle(l,"wait");},stopSpinner:function(){if(0===r()){e.one(A).setStyle(l,"default");}},bind:function(L,K){var I,J;if(K){b("Binding selected methods: "+K,f);for(J=0;J<K.length;J++){I=K[J];if(e.Lang.isFunction(L[I])){this.usePrivate(e.bind(L[I],L),I);}else{b("Wrong argument passed to inlineXHR::bind: "+I,n);}}}else{for(J in L){if(0!==J.indexOf("_")){this.usePrivate(L[J],J);}}}if(e.dump){b("Dumping clientMethods: "+e.dump(q),f);}}});e.Base.InlineXhr=a;},"gallery-2011.10.27-17-03",{optional:["io-form"],requires:["json-parse","node","io-base","base"]});