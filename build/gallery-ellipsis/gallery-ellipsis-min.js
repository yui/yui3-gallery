YUI.add("gallery-ellipsis",function(a){a.DOM.ellipsis=function(e,k){k=k||{};a.mix(k,{"ellipsis":" ...","fudge":3,"lines":1});var j=a.one(e),g=j.getAttribute("originalText")||j.get("text"),h=g.length,f=h,n=a.one(document.createElement(j.get("nodeName"))),b=0.01,m=function(r,q){return Math.abs(r-q)<=b;},c=function(r,q){return r-q>=b;},o=function(r,q){return r-q<=b;},p,i,d,l;n.setStyles({"overflow":"hidden","position":"absolute","visibility":"hidden","display":"block","bottom":"-10px","right":"-10px","width":j.getComputedStyle("width"),"fontSize":j.getComputedStyle("fontSize"),"fontFamily":j.getComputedStyle("fontFamily"),"fontWeight":j.getComputedStyle("fontWeight"),"letterSpacing":j.getComputedStyle("letterSpacing"),"lineHeight":j.getComputedStyle("lineHeight")});n.set("text","some sample text");a.one("body").append(n);p=parseFloat(n.getComputedStyle("height"),10);n.setStyle("overflow","visible");i=k.lines*p;n.set("text",g);d=parseFloat(n.getComputedStyle("height"),10);if(o(d,i)&&g.length===j.get("text").length){n.remove();return;}for(;f>=1;){f=Math.floor(f/2);h+=c(d,i)?-f:+f;n.set("text",g.slice(0,h-k.ellipsis.length)+k.ellipsis);d=parseFloat(n.getComputedStyle("height"),10);if(m(d,i)||o(d,i)){l=h;}}n.remove();if(!j.getAttribute("originalText")){j.setAttribute("originalText",g);}if(g.length===(n.get("text").length-k.ellipsis.length)){j.set("text",g);}else{if("undefined"!==typeof l){j.set("text",g.slice(0,l-k.ellipsis.length-k.fudge)+k.ellipsis);}}return j;};a.Node.importMethod(a.DOM,"ellipsis");a.NodeList.importMethod(a.Node.prototype,"ellipsis");},"gallery-2011.02.02-21-07",{requires:["base","node"]});