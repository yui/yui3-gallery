YUI.add("gallery-aui-image-viewer-gallery",function(T){var O=T.Lang,f=O.isBoolean,AG=O.isNumber,n=O.isObject,R=O.isString,Q="autoPlay",v="body",o="content",F="currentIndex",q="delay",Y=".",l="entry",H="handler",y="hidden",t="href",E="image-gallery",h="img",Z="left",s="links",r="offsetWidth",V="overlay",X="page",AJ="paginator",g="paginatorEl",i="paginatorInstance",J="pause",e="paused",C="pausedLabel",AA="play",a="player",c="playing",P="playingLabel",AH="px",N="repeat",U="showPlayer",B=" ",AC="src",AB="thumb",w="toolbar",AI="totalLinks",W="useOriginalImage",j="viewportRegion",AF="visible",d=function(){return Array.prototype.slice.call(arguments).join(B);},K=T.ClassNameManager.getClassName,m=K(E,AJ),S=K(E,AJ,o),p=K(E,AJ,l),u=K(E,AJ,s),AE=K(E,AJ,AB),D=K(E,a),x=K(E,a,o),G=K(V,y),AL="(playing)",M='<div class="'+S+'">{PageLinks}</div>',b='<span class="'+p+'"><span class="'+AE+'"></span></span>',I='<div class="'+u+'"></div>',AK='<div class="'+d(G,m)+'"></div>',z='<div class="'+D+'"></div>',AD='<span class="'+x+'"></span>';var k=T.Component.create({NAME:E,ATTRS:{autoPlay:{value:false,validator:f},delay:{value:7000,validator:AG},paginator:{value:{},setter:function(L){var A=this;var AN=A.get(g);var AM=A.get(AI);return T.merge({containers:AN,pageContainerTemplate:I,pageLinkContent:T.bind(A._setThumbContent,A),pageLinkTemplate:b,template:M,total:AM,on:{changeRequest:function(AO){A.fire("changeRequest",{state:AO.state});}}},L);},validator:n},paginatorEl:{readyOnly:true,valueFn:function(){return T.Node.create(AK);}},paginatorInstance:{value:null},paused:{value:false,validator:f},pausedLabel:{value:"",validator:R},playing:{value:false,validator:f},playingLabel:{value:AL,validator:R},repeat:{value:true,validator:f},showPlayer:{value:true,validator:f},toolbar:{value:{},setter:function(L){var A=this;return T.merge({children:[{id:AA,icon:AA},{id:J,icon:J}]},L);},validator:n},useOriginalImage:{value:false,validator:f}},EXTENDS:T.ImageViewer,prototype:{toolbar:null,_timer:null,renderUI:function(){var A=this;k.superclass.renderUI.apply(this,arguments);A._renderPaginator();if(A.get(U)){A._renderPlayer();}},bindUI:function(){var A=this;k.superclass.bindUI.apply(this,arguments);A._bindToolbarUI();A.on("playingChange",A._onPlayingChange);A.on("pausedChange",A._onPausedChange);A.publish("changeRequest",{defaultFn:this._changeRequest});},destroy:function(){var A=this;k.superclass.destroy.apply(this,arguments);A.get(i).destroy();},hidePaginator:function(){var A=this;A.get(g).addClass(G);},pause:function(){var A=this;A.set(e,true);A.set(c,false);A._syncInfoUI();},play:function(){var A=this;A.set(e,false);A.set(c,true);A._syncInfoUI();},show:function(){var A=this;var AM=A.getCurrentLink();if(AM){A.showMask();T.ImageViewer.superclass.show.apply(this,arguments);var L=A.get(i);L.set(X,A.get(F)+1);L.changeRequest();}},showPaginator:function(){var A=this;A.get(g).removeClass(G);},_bindToolbarUI:function(){var A=this;if(A.get(U)){var L=A.toolbar;var AN=L.item(AA);var AM=L.item(J);if(AN){AN.set(H,T.bind(A.play,A));}if(AM){AM.set(H,T.bind(A.pause,A));}}},_cancelTimer:function(){var A=this;if(A._timer){A._timer.cancel();}},_renderPaginator:function(){var A=this;var AM=A.get(g);T.one(v).append(AM.hide());var L=new T.Paginator(A.get(AJ)).render();A.set(i,L);},_renderPlayer:function(){var A=this;var AM=A.get(g);var L=T.Node.create(AD);AM.append(T.Node.create(z).append(L));A.toolbar=new T.Toolbar(A.get(w)).render(L);},_startTimer:function(){var A=this;var L=A.get(q);A._cancelTimer();A._timer=T.later(L,A,A._syncSlideShow);},_syncControlsUI:function(){var A=this;k.superclass._syncControlsUI.apply(this,arguments);if(A.get(AF)){A._syncSelectedThumbUI();A.showPaginator();}else{A.hidePaginator();A._cancelTimer();}},_syncSelectedThumbUI:function(){var A=this;var AM=A.get(F);var L=A.get(i);var AN=L.get(X)-1;if(AM!=AN){L.set(X,AM+1);L.changeRequest();}},_syncSlideShow:function(){var A=this;if(!A.hasNext()){if(A.get(N)){A.set(F,-1);}else{A._cancelTimer();}}A.next();},_changeRequest:function(A){var AR=this;var AN=A.state.paginator;var AM=A.state;var AQ=AM.before;var AP=AM.page;if(!AR.get(AF)){return false;}var AO=AR.get(F);var L=AP-1;if(!AQ||(AQ&&AQ.page!=AP)){AR.set(F,L);AR.loadImage(AR.getCurrentLink().attr(t));AN.setState(AM);var AT=AR.get(e);var AS=AR.get(c);if(AS&&!AT){AR._startTimer();}}},_setThumbContent:function(AR,L){var A=this;var AN=L-1;var AP=A.getLink(AN);var AQ=AR.one(Y+AE);var AO=null;if(A.get(W)){AO=AP.attr(t);}else{var AM=AP.one(h);if(AM){AO=AM.attr(AC);}}if(AO&&AQ.getData("thumbSrc")!=AO){AQ.setStyles({backgroundImage:"url("+AO+")"});AQ.setData("thumbSrc",AO);}},_getInfoTemplate:function(L){var AM;var A=this;var AO=A.get(e);var AN=A.get(c);if(AN){AM=A.get(P);}else{if(AO){AM=A.get(C);}}return d(k.superclass._getInfoTemplate.apply(this,arguments),AM);},_afterVisibleChange:function(L){var A=this;k.superclass._afterVisibleChange.apply(this,arguments);if(L.newVal){if(A.get(Q)){A.play();}}},_onPausedChange:function(L){var A=this;if(L.newVal){A._cancelTimer();}},_onPlayingChange:function(L){var A=this;if(L.newVal){A._startTimer();}}}});T.ImageGallery=k;},"gallery-2010.08.18-17-12",{skinnable:true,requires:["gallery-aui-image-viewer-base","gallery-aui-paginator","gallery-aui-toolbar"]});