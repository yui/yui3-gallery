YUI.add("gallery-patch-340-datatable-formatter",function(e){var c=e.Node.create,b=e.Lang,d=b.sub,a=e.ClassNameManager.getClassName("datatable","liner");e.mix(e.DataTable.Base.prototype,{_uiSetRecordset:function(h){var p=this._tbodyNode,t=p.get("parentNode"),j=p.next(),g=this.get("columnset").keys.slice(),l=this.get("tdValueTemplate"),r=this.get("trTemplate"),u=this.tdTemplate,q,k,o,f,n,s;p.remove();p=null;q=this._addTbodyNode(this._tableNode);q.remove();this._tbodyNode=q;function m(){if(!this.td){this.td=c(d(u,this));}return this.td.one("."+a)||this.td;}for(k=g.length-1;k>=0;--k){f=g[k];g[k]={column:f,field:f.get("field"),classnames:f.get("classnames"),headers:f.headers};s=f.get("formatter");if(!b.isFunction(s)){if(!b.isString(s)){s=l;}s=e.bind(d,this,s);}g[k].formatter=s;}for(k=0,o=h.size();k<o;++k){n=h.item(k);this._addTbodyTrNode({tbody:q,columns:g,rowTemplate:r,record:n,data:n.get("data"),rowindex:k,createCell:m});}t.insert(this._tbodyNode,j);},_addTbodyTrNode:function(g){var f=g.tbody.one("#"+g.record.get("id"));g.tr=f||this._createTbodyTrNode(g);this._attachTbodyTrNode(g);},_createTbodyTrNode:function(m){var h=m.columns,l=c(d(m.rowTemplate,{id:m.data.id})),g,f,k,j;for(g=0,f=h.length;g<f;++g){j=h[g];k=e.Object(m);k.tr=l;k.column=j.column;k.field=j.field;k.formatter=j.formatter;k.classnames=j.classnames;k.headers=j.headers;this._addTbodyTdNode(k);l=k.tr;}return l;},_addTbodyTdNode:function(f){this._createTbodyTdNode(f);this._attachTbodyTdNode(f);},_createTbodyTdNode:function(f){f.value=this.formatDataCell(f);if(!f.td){f.td=c(d(this.tdTemplate,f));}},formatDataCell:function(f){f.value=f.data[f.field];return f.formatter.call(this,f);}},true);},"gallery-2011.08.24-23-44",{requires:["datatable-base"]});