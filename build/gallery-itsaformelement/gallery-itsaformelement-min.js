YUI.add("gallery-itsaformelement",function(e,t){"use strict";var n,r=e.Array,i=e.Object,s=e.Lang,o=e.Intl,u=5,a=e.one("body"),f=5e3,l=l,c="data",h="hotkey",p=c+"-for",d=p+h,v="disabled",m="widget",g="string",y="itsa-"+m+"-parent",b="pure",w="button",E=b+"-"+w,S=E+"-active",x=" itsa"+w+"-bordered",T="date",N="time",C=T+N,k=" "+E+"-"+C+" itsa"+w+"-onlyicon",L=E+"-"+v,A=E+"-primary",O="modelattribute",M="hideatstartup",_="itsa-invisible",D="renderpromise",P="gallery",H="-itsa",B="editor",j="error",F="boolean",I="[data-formelement][data-content]",q='[data-valid="false"]',R="tipsy-formelement",U="boundingBox",z="touchstart",W="touchend",X="focus",V="blur",$="keypress",J="right",K="picker",Q="click",G="itsaicon-datetime-",Y=G+T,Z=G+N,et=G+C,tt=' data-formelement="true"',nt='<span class="format',rt="</span>",it="itsa-"+h,st='<span class="'+it+'" data-'+h+'="{'+h+'}" '+d+'="{nodeid}">$1'+rt,ot="itsabutton-asktoclick",ut="^[\\w!#$%&'*+/=?`{|}~^-]+(?:\\.[\\w!#$%&'*+/=?`{|}~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$",at="[a-zA-Z0-9-]+(\\.[a-zA-Z0-9-]+)+(/[\\w-]+)*",ft="^(http://)?"+at,lt="^https://"+at,ct="^(https?://)?"+at,ht="^(([-]?[1-9][0-9]*)|0)$",pt="^[-]?(([1-9][0-9]*)|0)(\\.[0-9]+)?$",dt='<label for="',vt="</label>",mt="text",gt="password",yt="email",bt="url",wt="radio",Et="checkbox",St="hidden",xt="textarea",Tt="div",Nt="label",Ct="span",kt="plain",Lt="initialfocus",At="fullselect",Ot="submitonenter",Mt="primarybtnonenter",_t="number",Dt=b+"-"+wt,Pt=b+"-"+Et,Ht="readonly",Bt="checked",jt="required",Ft="name",It="value",qt="placeholder",Rt="pattern",Ut="class",zt="labelHTML",Wt="switch",Xt=Wt+"ed",Vt=Wt+Nt,$t=Wt+It,Jt=Nt+c,Kt=It+Xt,Qt=It+"non"+Xt,Gt="focusable",Yt="spinbusy",Zt="{"+v+"}",en="{"+Ht+"}",tn="{"+Bt+"}",nn="{"+jt+"}",rn="{"+Ft+"}",sn="{"+It+"}",on="{"+qt+"}",un="{"+Rt+"}",an="{"+c+"}",fn="{"+Ut+"}",ln="{"+St+"}",cn='id="{id}"',hn="{"+Kt+"}",pn="{"+Qt+"}",dn="{"+Jt+"}",vn="{"+zt+"}",mn="{"+Gt+"}",gn="type",yn="submit",bn="reset",wn="<input "+gn+'="',En="<"+w+" "+gn+'="',Sn=Ut+Ft,xn=Nt+"Class"+Ft,Tn="{"+gn+"}",Nn=' data-labeldatetime="true"',Cn=c+"-"+C+"=",kn=c+"-"+w+gn,Ln=c+"-"+w+"sub"+gn,An="<"+Ct+" "+cn+">UNDEFINED ELEMENTTYPE</"+Ct+">",On="<"+Ct+" "+cn+rn+an+ln+fn+">"+sn+"</"+Ct+">",Mn=wn+mt+'" '+cn+rn+sn+on+Zt+nn+en+un+an+mn+ln+fn+" />",_n=wn+gt+'" '+cn+rn+sn+on+Zt+nn+en+un+an+mn+ln+fn+" />",Dn=wn+mt+'" '+cn+rn+sn+on+Zt+nn+en+an+mn+ln+fn+un+" />",Pn=wn+mt+'" '+cn+rn+sn+on+Zt+nn+en+an+mn+ln+fn+un+" />",Hn=wn+mt+'" '+cn+rn+sn+on+Zt+nn+en+an+mn+ln+fn+un+" />",Bn=wn+wt+'" '+cn+rn+sn+Zt+tn+an+mn+ln+fn+" />",jn=wn+Et+'" '+cn+rn+sn+Zt+en+tn+an+mn+ln+fn+" />",Fn=wn+St+'" '+cn+rn+sn+" />",In="<"+xt+" "+cn+rn+on+Zt+nn+en+an+mn+ln+fn+">"+sn+"</"+xt+">",qn=pn+"<"+Tt+" "+cn+rn+ln+an+mn+fn+"></"+Tt+">"+hn,Rn=En+Tn+'" '+cn+rn+sn+an+mn+ln+fn+">"+vn+"</"+w+">",Un=pn+En+w+'" '+cn+rn+sn+ln+nn+Nn+en+" "+Cn+'"'+T+'"'+an+mn+fn+"><i "+Ut+'="'+Y+'"></i></'+w+">"+hn,zn=pn+En+w+'" '+cn+rn+sn+ln+nn+Nn+en+" "+Cn+'"'+N+'"'+an+mn+fn+"><i "+Ut+'="'+Z+'"></i></'+w+">"+hn,Wn=pn+En+w+'" '+cn+rn+sn+ln+nn+Nn+en+" "+Cn+'"'+C+'"'+an+mn+fn+"><i "+Ut+'="'+et+'"></i></'+w+">"+hn,Xn={widget:qn,plain:On,text:Mn,password:_n,email:Dn,url:Pn,number:Hn,radio:Bn,checkbox:jn,hidden:Fn,textarea:In,button:Rn,reset:Rn,submit:Rn,date:Un,time:zn,datetime:Wn},Vn=function(t,n,r,i,s,o,u,a,f){var l=s?" "+s:"",c=a?" "+_:"",h=typeof n===g&&n.length>0?" formattime-"+n:"";return i||(t==="date"?i="%x":t==="time"?i="%X":i="%x %X"),e.use(P+H+"datetimepicker"),nt+"value"+h+l+c+'" '+p+'="'+f+'"'+l+o+u+">"+e.Date.format(r,{format:i})+rt},$n={date:!0,time:!0,datetime:!0},Jn={text:!0,number:!0,password:!0,textarea:!0,email:!0,url:!0},Kn={button:!0,submit:!0,reset:!0},Qn={radio:!0,checkbox:!0},Gn=/\{\s*([^|}]+?)\s*(?:\|([^}]*))?\s*\}/g,Yn=function(t,n){return t.replace?t.replace(Gn,function(t,r){return e.Lang.isUndefined(n[r])?"":n[r]}):t};e.Node.prototype.displayInDoc=function(){var e=this,t=e.inDoc();while(e&&t)t=e.getStyle("display")!=="none",t&&(e=e.get("parentNode"));return t},n=e.ITSAFormElement={},n.getElement=function(t,r,i){var s,o,u,a;i=i||e.guid(),r=r||{},o=typeof t=="function"&&t.NAME,typeof t===g&&(t=t.toLowerCase()),s={type:t,nodeid:i,config:r,name:r.name,html:n._renderedElement(o?t.NAME:t,r,i,o)};if(o){u=t;try{a=s.widget=new u(r.widgetconfig),t.NAME===B+"Base"?e.use(P+H+B+D,function(){a.renderOnAvailable("#"+i,f)}):e.use(P+H+m+D,function(){a.renderOnAvailable("#"+i,f)})}catch(l){e.fire(j,l)}}return s},n._renderedElement=function(t,u,a,f){var l=e.merge(u),d=$n[t],b=typeof l[Vt]===F?l[Vt]:!1,S=typeof l[Gt]===F?l[Gt]:!0,T=typeof l[At]===F?l[At]:!1,N=typeof l[Ot]===F?l[Ot]:!1,D=typeof l[Mt]===F?l[Mt]:!1,B=typeof l[M]===F?l[M]:!1,j=!d&&u.tooltip,I=!d&&u.tooltipinvalid,q=u.nossl,R=u.onlyssl,U=u.digits,z=u[It],W=u[O],X=u[$t],V=u[c],$=tt,J=u[h],K,Q,G,Y,Z,et,it,ot,at,mt,Et,Tt,Ct,Wt,Xt,Zt,en,tn,nn;return V&&($+=" "+V),W&&($+=" data-"+O+'="true"'),l[c]=$,j&&(j=j.replace(/"/g,"''"),l[c]+=' data-content="'+j+'" data-contentvalid="'+j+'"'),I&&typeof I===g&&I.length>0&&(l[c]+=' data-contentinvalid="'+I.replace(/"/g,"''")+'"'),u[Lt]&&(l[c]+=" data-"+Lt+'="true"'),u[Ft]&&(l[Ft]=" "+Ft+'="'+l[Ft]+'"'),et=typeof u[St]===F?u[St]:!1,it=typeof l[v]===F?l[v]:!1,l[St]=et?" "+St+'="'+St+'"':"",l[v]=it?" "+v+'="'+v+'"':"",J&&(s.isObject(J)&&(Xt=o.getLang(P+"-itsaformelement")||e.config.lang,tn=[],i.each(J,function(e,t){typeof t===g&&typeof e===g&&tn.push(t)}),en=0,nn=Xt.length,r.some(tn,function(e){var t=e.length;return(t>en&&(en===0||t<=nn)||t<en&&en>nn)&&Xt.match(new RegExp("^"+e))&&(Zt=e,en=Zt.length),e===Xt}),J=J[Zt]),typeof J===g&&J.length===1&&(Wt=J.toLowerCase())),f?(l[c]+=' data-type="'+t+'"',l[Ut]=' class="'+(u[Sn]||"")+" "+y+(B?" "+_:"")+'"',u[Nt]&&(l[Jt]=l[Jt]||"",l[Jt]+=" data-"+m+Nt+'="true"'),l[Gt]=S?" data-"+Gt+'="true"':"",t==="slider"&&(l[X?Kt:Qt]=nt+"value formatslider-"+u.name+(u[Sn]?" "+u[Sn]:"")+'" '+p+'="'+a+'"'+l[St]+l[v]+">"+z+rt),t=m):(ot=!u["remove"+jt]&&(typeof l[jt]===F?l[jt]:t===gt),Et=typeof l[Ht]===F?l[Ht]:!1,l[Gt]=S?" data-"+Gt+'="true"'
:"",l[jt]=ot?" "+jt+'="'+jt+'"':"",l[Ht]=Et?" "+Ht+'="'+Ht+'"':"",u[qt]&&(l[qt]=" "+qt+'="'+l[qt]+'"'),u[Rt]&&(l[Rt]=" "+Rt+'="'+l[Rt]+'"'),t!==xt&&t!==kt&&z&&(l[It]=" "+It+'="'+l[It]+'"'),t===yt?(l[c]+=' data-subtype="email"',l[Rt]=" "+Rt+'="'+ut+'"'):t===bt?(l[c]+=' data-subtype="url"',typeof q===F&&q?l[Rt]=" "+Rt+'="'+ft+'"':typeof R===F&&R?l[Rt]=" "+Rt+'="'+lt+'"':l[Rt]=" "+Rt+'="'+ct+'"'):t===_t?l[Rt]=" "+Rt+'="'+(typeof U===F&&U?pt:ht)+'"':Qn[t]?(Z=t===wt?Dt:Pt,at=typeof l[Bt]===F?l[Bt]:!1,l[Bt]=at?" "+Bt+'="'+Bt+'"':""):Kn[t]?(delete l[Nt],mt=!0,l[gn]=t,l[c]+=" data-"+w+gn+'="'+(u[w+gn]||t)+'"',G=u.primary,Q=it,u[Yt]&&(l[c]+=" data-"+Yt+'="true"',e.use(P+"css"+H+"-animatespin")),u[zt]||(l[zt]=z||t),l[It]=" "+It+'="'+(u[It]||e.Escape.html(l[zt]))+'"',Wt&&(Ct=new RegExp("(?![^<]*>)("+Wt+")","i"))&&Ct.test(l[zt])&&(l[zt]=l[zt].replace(Ct,s.sub(st,{hotkey:Wt,nodeid:a})),n._HKList||n._actHKList())):d&&(e.use(P+"css"+H+"-"+C),s.isDate(z)||(z=new Date),mt=!0,Q=it,l[It]=' value="'+z.getTime()+'"',l[c]+=" data-"+C+'picker="true"',l[X?Kt:Qt]=Vn(t,u.name||"",z,l.format,u[Sn],l[St],l[v],B,a)),u.removepattern&&l[Rt]&&(l[c]+=" data-"+Rt+"="+l[Rt].substr(9),delete l[Rt]),Jn[t]&&(n._TXTList||n._actTXTList()),T&&Jn[t]&&(l[c]+=" data-"+At+'="true"'),N&&Jn[t]&&(l[c]+=" data-"+Ot+'="true"'),D&&Jn[t]&&(l[c]+=" data-"+Mt+'="true"'),(u[Sn]||mt||B||d)&&(l[Ut]=' class="'+(d?"":u[Sn]||"")+(mt?" "+E+x:"")+(d?k:"")+(Q?" "+L:"")+(G?" "+A:"")+(B?" "+_:"")+'"')),Y=Xn[t]||An,l[Nt]&&(Wt&&(Ct=new RegExp("(?![^<]*>)("+Wt+")","i"))&&Ct.test(l[Nt])&&(l[Nt]=l[Nt].replace(Ct,s.sub(st,{hotkey:Wt,nodeid:a})),n._HKList||n._actHKList()),b&&(l[xn]+=" switched"+Nt),Z?(l[Nt]='<span class="formatlabel">'+l[Nt]+rt,K=' class="'+Z+(l[xn]?" "+l[xn]:"")+'"',Y=dt+'{id}"'+ln+dn+K+">"+(b?Y+"{label}":"{label}"+Y)+vt):(K=l[xn]?' class="'+l[xn]+'"':"",Tt=(d?"<"+Nt:dt+'{id}"')+ln+dn+K+">{label}"+vt,b?Y+=Tt:Y=Tt+Y)),l.id=a,Yn(Y,l)},n.tooltipReadyPromise=function(){return n._tooltipreadypromise||(n._tooltipreadypromise=new e.Promise(function(t,r){var i=n.tipsyOK=(new e.Tipsy({placement:J,selector:I+":not("+q+")",showOn:[z,X],hideOn:[W,V,$],zIndex:u})).render(),s=n.tipsyInvalid=(new e.Tipsy({placement:J,selector:I+q,showOn:[z,X],hideOn:[W,V,$],zIndex:u})).render();i.get(U).addClass(R+"-ok"),s.get(U).addClass(R+"-invalid"),i._alignTooltip=function(t){var n=this;e.Tipsy.prototype._alignTooltip.apply(n,arguments),n._lastnode=t},s._alignTooltip=function(t){var n=this;e.Tipsy.prototype._alignTooltip.apply(n,arguments),n._lastnode=t},e.batch(i.renderPromise(),s.renderPromise()).then(t,r)})),n._tooltipreadypromise},n._pressedBtn=null,n._actHKList=function(){n._HKList=!0,a.on("keydown",function(t){var r=t.charCode,i,s,o,u,a;t.altKey&&(i=String.fromCharCode(r).toLowerCase(),s=e.one("."+it+"[data-"+h+'="'+i+'"]:not(['+v+"]):not(["+Ht+"])"),s&&(o=s.getAttribute(d),u=e.one("#"+o)),u&&(u.getStyle("visibility")==="hidden"||!u.displayInDoc())?(s=e.all("."+it+"[data-"+h+'="'+i+'"]:not(['+v+"]):not(["+Ht+"])"),s.some(function(t,n){return n>0&&(o=t.getAttribute(d),u=e.one("#"+o),a=u&&u.getStyle("visibility")!=="hidden"&&u.displayInDoc()&&u),a})):a=u,a&&(t.halt(),a.focus(),a.get("tagName")==="BUTTON"&&(a.addClass(S),e.fire(ot,{buttonNode:a}),n._pressedBtn=a)))}),a.on("keyup",function(){var e=n._pressedBtn;e&&(e.removeClass(S),n._pressedBtn=null)})},n._actTXTList=function(){n._TXTList=!0,a.delegate(X,function(t){var n=t.target,r=n.getAttribute(c+"-"+At)==="true",i;!r&&n.test("input")&&t.preventDefault(),i=n.getData(l),e.ITSAFormElement._activeNode=n,i?n.clearData(l):r?n.select():(n.set("selectionStart",n.get("value").length),n.set("scrollTop",999999))},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],textarea")}),a.delegate("mousedown",function(t){var n=t.target;e.ITSAFormElement._activeNode!==n&&n.setData(l,!0)},function(e,t){var n=t.target;return e===n&&n.test("input[type=text],input[type=password],textarea")})},e.later(500,null,n.tooltipReadyPromise),r.each([T,N,C],function(t){var n={on:function(e,n,r){n._handle=e.on(Q,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&n.getAttribute(c+"-"+C)===t&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+K+Q,n)}),r.each([yn,bn],function(t){var n={on:function(e,n,r){n._handle=e.on(Q,function(e){var n=e.target;n&&n.get("tagName")!=="BUTTON"&&(n=n.get("parentNode"),e.target=n),n&&(n.getAttribute(kn)===t||n.getAttribute(kn)===w&&n.getAttribute(Ln)===t)&&r.fire(e)})},detach:function(e,t){t._handle.detach()}};n.delegate=n.on,n.detachDelegate=n.detach,e.Event.define(t+":"+Q,n)})},"@VERSION@",{requires:["yui-base","node-core","node-event-delegate","datatype-date-format","event-base","event-synthetic","yui-later","promise","event-tap","event-custom","node-style","escape","yui-later","intl","gallerycss-itsa-base","gallery-tipsy","gallery-itsawidgetrenderpromise"],skinnable:!0});
