YUI.add("gallery-deferred",function(b){var g=b.Lang,j=b.Array,k=Array.prototype,f=k.slice,h=k.push,c=1,e=2;function i(l){this._config=l||{};this._done=[];this._fail=[];this._args=[];this.status=0;}b.mix(i.prototype,{then:function(m,l){if(m){m=i._flatten(m);if(this.status===c){j.each(m,function(n){n.apply(this,this._args);},this);}else{h.apply(this._done,m);}}if(l){l=i._flatten(l);if(this.status===e){j.each(l,function(n){n.apply(this,this._args);},this);}else{h.apply(this._fail,l);}}return this;},done:function(){return this.then(j(arguments));},fail:function(){return this.then(null,j(arguments));},always:function(){var l=j(arguments);return this.then(l,l);},resolve:function(){this.status=c;return this._notify(j(arguments));},reject:function(){this.status=e;return this._notify(j(arguments));},_notify:function(m){var n=[],l=this;if(this.status===c){n=this._done;this._done=[];}else{if(this.status===e){n=this._fail;this._fail=[];}}j.each(n,function(o){o.apply(l,m);});return this;},defer:function(n,l){var m=new this.constructor(this._config);this.then(b.bind(n,l||this,m));return m;}});i._flatten=function(l){var m=0;l=g.isArray(l)?l.concat():[l];while(m<l.length){if(g.isArray(l[m])){k.splice.apply(l,[m,1].concat(l[m]));}else{m++;}}return l;};b.Promise=i;b.defer=function(m,l){var n=new b.Promise();m(n);return n;};b.when=function(){var n=b.Promise._flatten(j(arguments)),m=[],l=0,o=0;return b.defer(function(s){function r(u,t){m[u]=t;if(l+o===n.length){if(o>0){s.reject.apply(s,m);}else{s.resolve.apply(s,m);}}}function q(t){l++;r(t,f.call(arguments,1));}function p(t){o++;r(t,f.call(arguments,1));}j.each(n,function(t,u){if(b.Lang.isFunction(t)){q(u,t());}else{t.then(b.bind(q,t,u),b.bind(p,t,u));}});});};function a(){a.superclass.constructor.apply(this,arguments);}b.extend(a,b.Promise,null,{NAME:"io-request"});if(b.io){b.mix(b.io,{Request:a,_normalizeConfig:function(m,l){if(b.Lang.isFunction(m)){m={on:{complete:m}};}else{m=m||{};m.on=m.on||{};}return b.mix(m,l,true);},_eventsToCallbacks:function(m,l){b.each(l,function(o,n){if(n==="success"){m.done(o);}else{if(n==="failure"){m.fail(o);}else{m.always(o);}}});},defer:function(l){var m=new b.io.Request();l.call(this,m);return m;},addMethod:function(l,m){b.io[l]=m;a.prototype[l]=m;},addMethods:function(l){b.each(l,function(n,m){b.io.addMethod(m,n);});}});b.io.addMethods({_deferIO:function(m,l){l=b.io._normalizeConfig(l);return this.defer(function(n){if(l.on){b.io._eventsToCallbacks(n,l.on);}l.on={success:function(q,o){if(l.parser){try{args.data=l.parser(o.responseText);}catch(p){n.reject.apply(n,arguments);return;}}n.resolve.apply(n,arguments);},failure:b.bind(n.reject,n)};b.mix(n,b.io(m,l));});},_deferGet:function(o,m,l){var n;if(b.Lang.isFunction(l)){n=l;l={};}if(!l){l={};}return this.defer(function(p){if(n){p.then(n);}if(l.on){b.io._eventsToCallbacks(p,l.on);l.on=null;}b.Get[o](m,l,function(q){if(q){p.reject(q);}else{p.resolve();}});});},get:function(m,l){return this._deferIO(m,b.io._normalizeConfig(l,{method:"GET"}));},post:function(m,n,l){return this._deferIO(m,b.io._normalizeConfig(l,{method:"POST",data:n}));},postForm:function(m,n,l){return this._deferIO(m,b.io._normalizeConfig(l,{method:"POST",form:{id:n}}));},script:function(){return this.js.apply(this,arguments);},js:function(m,l){return this._deferGet("js",m,l);},css:function(m,l){return this._deferGet("css",m,l);}});if(b.JSON){b.io.addMethod("getJSON",function(m,l){l=b.io._normalizeConfig(l);l.parser=b.JSON.parse;return this._deferIO(m,l);});}if(b.jsonp){b.io.addMethod("jsonp",function(m,l){l=b.io._normalizeConfig(l);return this.defer(function(n){if(l.on){b.io._eventsToCallbacks(n,l.on);}l.on={success:b.bind(n.resolve,n),failure:b.bind(n.reject,n)};b.jsonp(m,l);});});}}function d(l){d.superclass.constructor.apply(this,arguments);this.host=l.host;}if(b.Node&&b.Plugin){b.extend(d,b.Promise,null,{NS:"deferred",deferMethod:function(l){d.prototype[l]=function(){var n,m,o;if(this.host.deferred===this){this.resolve();}if(this.host[l]){n=j(arguments);if(g.isFunction(n[n.length-1])){o=n.pop();}m=this.defer(function(p){this.host[l].apply(this.host,n.concat([b.bind(p.resolve,p)]));});if(o){m.done(o);}return m;}else{if(l=="load"&&b.instanceOf(this.host,b.NodeList)){b.error("NodeList doesn't have a "+l+"() method");}else{b.error("Missing required module for "+l);}}return this;};},importMethod:function(l){d.prototype[l]=function(){var m=arguments;return this.done(function(){this.host[l].apply(this.host,m);});};}});b.each(["hide","load","show","transition","once","onceAfter"],d.deferMethod);b.each(["addClass","append","appendTo","blur","clearData","destroy","empty","focus","insert","insertBefore","prepend","remove","removeAttribute","removeChild","removeClass","replaceChild","replaceClass","select","set","setAttrs","setContent","setData","setStyle","setStyles","setX","setXY","setY","simulate","swapXY","toggleClass","wrap","unwrap"],d.importMethod);b.Plugin.NodeDeferred=d;}},"gallery-2012.05.16-20-37",{optional:["node","plugin","node-load","transition","io-base","json","jsonp"]});