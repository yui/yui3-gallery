YUI.add("gallery-mru-cache",function(d){function b(e){this._metric_fn=e.metric;this._limit=e.limit;this._meta=e.meta;this._stats=e.stats?a():null;if(d.Lang.isFunction(e.stats)){this._stats_key_meta=e.stats;}this.clear();}function a(){return{gets:0,keys:{}};}function c(f,e){if(!f[e]){f[e]={puts:0,gets:0};}}b.prototype={get:function(e){var f=this._store[e];if(f){this._mru.prepend(f.mru);if(this._stats){this._stats.gets++;c(this._stats.keys,e);this._stats.keys[e].gets++;}return f.data;}},put:function(e,g){var f=!d.Lang.isUndefined(this._store[e]);if(f){return false;}var h={data:g,mru:this._mru.prepend(e)};if(this._meta){h.meta=this._meta(g);}this._store[e]=h;this._metric+=this._metric_fn(g);while(this._metric>this._limit){this.remove(this._mru.tail().value);}if(this._stats){c(this._stats.keys,e);this._stats.keys[e].puts++;if(this._stats_key_meta){this._stats_key_meta(e,g,this._stats.keys[e]);}}return true;},replace:function(e,f){var g=this.remove(e);this.put(e,f);return g;},remove:function(e){var f=this._store[e];delete this._store[e];if(f){this._mru.remove(f.mru);this._metric-=this._metric_fn(f.data);return f.data;}},clear:function(){this._store={};this._mru=new d.LinkedList();this._metric=0;},dumpStats:function(){var e=this._stats;this._stats=a();return e;}};d.MRUCache=b;},"gallery-2012.05.23-19-56",{requires:["gallery-linkedlist"]});