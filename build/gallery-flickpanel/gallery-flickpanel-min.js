YUI.add("gallery-flickpanel",function(b){function a(c){a.superclass.constructor.apply(this,arguments);}a.NAME="FlickPanelPlugin";a.NS="FlickPanel";a.PULL_TAB_MARKUP='<div class="pullTab"><div class="gripper">Pull-tab</div></div>';a.WINDOW_CHANGE_EVENT=(b.config.win.hasOwnProperty&&b.config.win.hasOwnProperty("onorientationchange"))?"orientationchange":"resize";a.ATTRS={};b.extend(a,b.Plugin.Base,{initializer:function(c){this.isOpen=false;this.deviceSupportsTouch=(b.config.win.hasOwnProperty&&b.config.win.hasOwnProperty("ontouchstart"));this.root=c.root||this.get("host");this.animateMain=c.animateMain||false;this.flickPanelNode=c.flickPanel;this.mainNode=c.main;this.yVal=this.flickPanelNode.getY();this.xPos=0;this.trackingDirection=null;this.flickPanelNode.append(a.PULL_TAB_MARKUP);this.pullTab=this.root.one(".pullTab");if(this.deviceSupportsTouch){this.pullTab.on("gesturemovestart",this._track,this,this);this.pullTab.on("gesturemove",this._track,this,this);this.pullTab.on("gesturemoveend",this._stopTracking,this,this);}if(this.animateMain){this.root.on("flick",this._onFlick,"",this);}this.windowListener_1=b.on(a.WINDOW_CHANGE_EVENT,this._windowChange,b.config.win,this);this.windowListener_2=b.on("touchmove",this._flickPanelScrollStop,b.config.win,this);this.windowListener_3=b.on("scroll",this._flickPanelScrollStop,b.config.win,this);this.windowListener_4=b.on("flickpanel.toggle.click",this._toggle,this);},destructor:function(){this.flickPanelNode.setStyle("position","");this.pullTab.remove();this._closePanel();this.pullTab.detach();this.root.detach("flick",this._onFlick);this.windowListener_1.detach();this.windowListener_2.detach();this.windowListener_3.detach();this.windowListener_4.detach();},_windowChange:function(){if(this.isOpen){this._slidePanels(this.flickPanelNode.get("offsetWidth"),false);}else{this._slidePanels(0,false);}},_onFlick:function(h){if(h.target.ancestor(".yui3-scrollview-horiz")||h.target.ancestor(".yui3-carousel")){return;}var c=h.flick,f,i=20,g=0.1,d="x",j=(h._event.changedTouches)?Math.abs(h._event.changedTouches[0].clientY-c.start.clientY):Math.abs(h.pageY-c.start.pageY);if(Math.abs(c.distance)<i||Math.abs(c.velocity)<g||c.axis!==d){return;}f=Math.atan2(j,c.distance);f=parseInt(f*180/Math.PI,10);if(f<=15){this._openPanel();}else{if(f>=165&&f<=180){this._closePanel();}}},_slidePanels:function(f,d){var e,g,c;if(b.UA.webkit){e="-webkit-";}else{if(b.UA.gecko){e="-moz-";}else{if(b.UA.opera){e="-o-";}else{if(b.UA.ie){e="-ms-";}else{e="";}}}}g=(b.UA.gecko)?"MozTransition":e+"transition";c=(b.UA.gecko)?"MozTransform":e+"transform";if(d){this.flickPanelNode.setStyle(g,e+"transform .25s ease-out");this.mainNode.setStyle(g,e+"transform .25s ease-out");}if(this.animateMain){this.mainNode.setStyle(c,"translateX("+f+"px)");}this.flickPanelNode.setStyle(c,"translateX("+f+"px)");},_openPanel:function(){var c=this.flickPanelNode.get("offsetWidth");this._slidePanels(parseInt(c,10),true);this.isOpen=true;b.fire("flickpanel.open",{});},_closePanel:function(){this._slidePanels(0,true);this.isOpen=false;b.fire("flickpanel.close",{});},_toggle:function(){if(this.flickPanelNode.get("clientWidth")!==0){if(!this.isOpen){this._openPanel();}else{this._closePanel();}}},_track:function(c){if(this.xPos<c.pageX){this.trackingDirection="opening";}else{this.trackingDirection="closing";}this.xPos=c.pageX;if(this.xPos>0&&this.xPos<this.flickPanelNode.get("offsetWidth")){this._slidePanels(this.xPos);}},_stopTracking:function(g){g.halt();var d=this.flickPanelNode.get("offsetWidth"),f=Math.round(d/3),c=d-22;this.xPos=g.pageX;if((this.trackingDirection==="opening"&&this.xPos>f)||this.xPos>c){this._openPanel();}else{this._closePanel();}},_flickPanelScrollStop:function(){var c=this.flickPanelNode,d=this.yVal,e=b.config.win;if(b.UA.ios&&b.UA.ios<5){if(e.scrollY>=d){c.setStyle("top",(e.scrollY-this.yVal)+"px");}else{c.setStyle("top","");}}else{if(e.scrollY>=d){c.setStyle("position","fixed");}else{c.setStyle("position","");}}}});b.FlickPanelPlugin=a;},"gallery-2012.06.27-20-10",{requires:["node","event","event-flick","event-move","plugin"],skinnable:false});