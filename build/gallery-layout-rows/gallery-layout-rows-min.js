YUI.add("gallery-layout-rows",function(d){var c=(0<d.UA.ie&&d.UA.ie<8),f=(0<d.UA.ie&&d.UA.ie<8),b=(0<d.UA.ie&&d.UA.ie<8);d.namespace("PageLayoutRows");d.PageLayoutRows.collapse_classes={vert_parent_class:d.PageLayout.module_rows_class,horiz_parent_class:d.PageLayout.module_class,collapse_parent_pattern:d.PageLayout.expand_vert_nub_class};function e(k,j){var l=k;if(b){var i=j.bd.get("offsetHeight");}var g=j.root.get("offsetHeight")-j.bd.get("offsetHeight");if(j.hd){l-=j.hd.get("offsetHeight");g-=j.hd.get("offsetHeight");}if(j.ft){l-=j.ft.get("offsetHeight");g-=j.ft.get("offsetHeight");}l-=g;l-=j.bd.vertMarginBorderPadding();return Math.max(l,d.PageLayout.min_module_height);}function a(g,l,j,k,i,h){h.mbp=i.horizMarginBorderPadding();return Math.max(1,Math.floor(g*l[j][k]/100)-h.mbp);}d.PageLayoutRows.resize=function(B,A,L,r){var y=B.body_info.outers.size();var l=[],I=[];for(var H=0;H<y;H++){var u=B.body_info.inner_sizes[H].slice(0);l.push(u);I.push(L);var K=0,m=0;var M=B.body_info.modules[H];var s=M.size();for(var G=0;G<s;G++){var g=M.item(G);g.setStyle("height","auto");if(g.hasClass(d.PageLayout.collapsed_horiz_class)){if(c){g.setStyle("display","none");}g.setStyle("width","auto");if(c){g.setStyle("display","block");}u[G]=-g.get("offsetWidth");I[H]-=g.totalWidth();}else{if(u[G]>0){K++;m+=u[G];}}}if(K<s){for(var G=0;G<s;G++){if(u[G]>0){u[G]*=(100/m);}}}}var D={};if(B.single_module){var g=B.body_info.modules[0].item(0);var o=B._analyzeModule(g);if(o.bd){var x=a(I[0],l,0,0,g,D);var v=Math.max(1,x-o.bd.horizMarginBorderPadding());B.fire("beforeResizeModule",{bd:o.bd,height:"auto",width:v});B._setWidth(o,x);o.root.setStyle("height","auto");o.bd.setStyle("height","auto");}var J=g.totalHeight();A=(J>r?d.PageLayout.FIT_TO_VIEWPORT:d.PageLayout.FIT_TO_CONTENT);B.body_container.removeClass("FIT_TO_[A-Z_]+");}if(A===d.PageLayout.FIT_TO_CONTENT){var p=[];for(var H=0;H<y;H++){B.body_info.outers.item(H).setStyle("height","auto");var M=B.body_info.modules[H];var J=0;var C=0;var z=M.size();var s=z;for(var G=0;G<s;G++){var x=l[H][G];var g=M.item(G);if(x<0){var N=false;if(x==d.PageLayout.unmanaged_size&&f){var o=B._analyzeModule(g);if(o.bd){var F=o.bd.totalWidth();C+=F+g.horizMarginBorderPadding();N=true;o.root.setStyle("width",F+"px");}}if(!N){C+=g.totalWidth();}z--;}}var E=0;for(var G=0;G<s;G++){var x=l[H][G];var g=M.item(G);if(x<0){if(x==d.PageLayout.unmanaged_size){var o=B._analyzeModule(g);if(o.bd){o.root.setStyle("height","auto");o.bd.setStyle("height","auto");}J=Math.max(J,g.get("offsetHeight"));}continue;}E++;var o=B._analyzeModule(g);if(o.bd){var x=a(I[H],l,H,G,g,D);C+=x+D.mbp;if(E==z){x+=L-C;}var v=Math.max(1,x-o.bd.horizMarginBorderPadding());B.fire("beforeResizeModule",{bd:o.bd,height:"auto",width:v});B._setWidth(o,x);o.root.setStyle("height","auto");o.bd.setStyle("height","auto");}J=Math.max(J,g.get("offsetHeight"));}p.push(J);}}else{var p=B.body_info.outer_sizes.slice(0);var K=0,m=0;for(var H=0;H<y;H++){var q=B.body_info.outers.item(H);var n=q.hasClass(d.PageLayout.collapsed_vert_class);if(n||p[H]<0){p[H]=0;if(n){q.setStyle("height","auto");}r-=q.one("*").totalHeight();r-=q.vertMarginBorderPadding();}else{K++;m+=p[H];}}if(K<y){for(var H=0;H<y;H++){p[H]*=(100/m);}}}for(var H=0;H<y;H++){if(A===d.PageLayout.FIT_TO_CONTENT){var J=p[H];}else{if(p[H]===0){var g=B.body_info.modules[H].item(0);var o=B._analyzeModule(g);if(o.bd){var t=o.bd.insideHeight();var x=a(I[H],l,H,0,g,D);var v=Math.max(1,x-o.bd.horizMarginBorderPadding());B.fire("beforeResizeModule",{bd:o.bd,height:t,width:v});B._setWidth(o,x);B.fire("afterResizeModule",{bd:o.bd,height:t,width:v});}continue;}var J=Math.max(1,Math.floor(r*p[H]/100)-B.body_info.outers.item(H).vertMarginBorderPadding());}B.body_info.outers.item(H).setStyle("height",J+"px");var M=B.body_info.modules[H];var C=0;var z=M.size();var s=z;for(var G=0;G<s;G++){var x=l[H][G];var g=M.item(G);if(x<0){var N=false;if(x==d.PageLayout.unmanaged_size){var o=B._analyzeModule(g);if(o.bd){var t=e(J,o);var v=o.bd.insideWidth();B.fire("beforeResizeModule",{bd:o.bd,height:t,width:v});o.bd.setStyle("height",t+"px");if(f){var F=o.bd.totalWidth();C+=F+g.horizMarginBorderPadding();N=true;o.root.setStyle("width",F+"px");}B.fire("afterResizeModule",{bd:o.bd,height:t,width:v});}}else{g.setStyle("height",Math.max(1,J-g.vertMarginBorderPadding())+"px");}if(!N){C+=g.totalWidth();}z--;}}var E=0;for(var G=0;G<s;G++){if(l[H][G]<0){continue;}E++;var g=M.item(G);var o=B._analyzeModule(g);if(o.bd){var t=e(J,o);var x=a(I[H],l,H,G,g,D);C+=x+D.mbp;if(E==z){x+=L-C;}var v=Math.max(1,x-o.bd.horizMarginBorderPadding());if(A===d.PageLayout.FIT_TO_VIEWPORT){B.fire("beforeResizeModule",{bd:o.bd,height:t,width:v});B._setWidth(o,x);}o.bd.setStyle("height",t+"px");B.fire("afterResizeModule",{bd:o.bd,height:t,width:v});}}}};},"gallery-2012.05.16-20-37",{requires:["gallery-layout"]});